<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">






  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Java,JVM,">










<meta name="description" content="JVM理解-class文件">
<meta name="keywords" content="Java,JVM">
<meta property="og:type" content="article">
<meta property="og:title" content="JVM理解-class文件">
<meta property="og:url" content="http://yannischeng.com/JVM理解-class文件/index.html">
<meta property="og:site_name" content="YannisCheng&#39;s Technology Blogs">
<meta property="og:description" content="JVM理解-class文件">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/java%E6%96%87%E4%BB%B6%E8%BF%90%E8%A1%8C.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/java-bin%E6%96%87%E4%BB%B6-%E5%86%85%E5%AE%B9.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6%E9%83%A8%E5%88%86%E6%A0%BC%E5%BC%8F.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B616%E8%BF%9B%E5%88%B6.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E5%B8%B8%E9%87%8F%E6%B1%A0-%E8%A1%A8.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E8%AE%BF%E9%97%AE%E6%A0%87%E5%BF%97.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E7%B1%BB%E3%80%81%E6%8E%A5%E5%8F%A3%E3%80%82%E7%88%B6%E7%B1%BB%E7%B4%A2%E5%BC%95.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E5%AD%97%E6%AE%B5%E8%A1%A8%E9%9B%86%E5%90%88.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E6%96%B9%E6%B3%95%E8%A1%A8.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E6%96%B9%E6%B3%95%E4%BD%93.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E6%96%B9%E6%B3%95%E4%BD%93-javap.png">
<meta property="og:updated_time" content="2019-02-24T00:06:57.465Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JVM理解-class文件">
<meta name="twitter:description" content="JVM理解-class文件">
<meta name="twitter:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/java%E6%96%87%E4%BB%B6%E8%BF%90%E8%A1%8C.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yannischeng.com/JVM理解-class文件/">





  <title>JVM理解-class文件 | YannisCheng's Technology Blogs</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">YannisCheng's Technology Blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">不必一味的讨好别人，每个人都有自己的活法。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yannischeng.com/JVM理解-class文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YannisCheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://oy991qm3u.bkt.clouddn.com/%E6%A2%B5%E9%AB%98.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YannisCheng's Technology Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">JVM理解-class文件</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-21T11:09:22+08:00">
                2018-11-21
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2019-02-24T08:06:57+08:00">
                2019-02-24
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,775 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  15 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    

    
        <div class="post-tags">
          
            <a href="/tags/Java/" rel="tag"># Java</a>
          
            <a href="/tags/JVM/" rel="tag"># JVM</a>
          
        </div>
      

    
    
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    YannisCheng
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://yannischeng.com/JVM理解-class文件/" title="JVM理解-class文件">http://yannischeng.com/JVM理解-class文件/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    尊重个人劳动成果，转载请注明出处。 ─=≡Σ(((つ•̀ω•́)つ))
  </li>
</ul>

      </div>
    



    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <p>JVM理解-class文件</p>
<a id="more"></a>
<blockquote>
<p>参考：<a href="https://blog.csdn.net/brave2211/column/info/zhangjg-java-blog" target="_blank" rel="noopener">https://blog.csdn.net/brave2211/column/info/zhangjg-java-blog</a></p>
</blockquote>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h2 id="1-JVM是什么"><a href="#1-JVM是什么" class="headerlink" title="1. JVM是什么"></a>1. JVM是什么</h2><p><code>VM</code>是一种<code>抽象化</code>的计算机，是通过在实际的计算机上仿真<code>模拟</code>各种计算机功能来实现的。<br><code>JVM</code>有自己完善的硬件体系架构，如：处理器、堆栈、寄存器等，还具有相应的指令系统。<code>JVM``屏蔽</code>了具体操作系统平台的相关信息，使得<code>Java程序</code>只需要在<code>JVM</code>上运行<code>目标代码（字节码）</code>，就可以实现<code>跨平台</code>。</p>
<p>以上这些描述仅仅是从<code>JVM外部</code>来对其进行解释，而<strong><code>JVM理解</code></strong>这一系列文章则是针对<code>JVM内部</code>来进行解释。</p>
<h2 id="2-进程与JVM"><a href="#2-进程与JVM" class="headerlink" title="2. 进程与JVM"></a>2. 进程与JVM</h2><p><code>进程</code>是操作系统中的执行单位，而<code>JVM</code>又是运行在操作系统中，由此关系可以看出：<code>JVM</code>是操作系统中的一个<code>进程实例</code>，当<code>JVM</code>没有运行时，是一个 <code>安静的程序</code></p>
<h3 id="一个Java程序的运行"><a href="#一个Java程序的运行" class="headerlink" title="一个Java程序的运行"></a>一个Java程序的运行</h3><p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/java%E6%96%87%E4%BB%B6%E8%BF%90%E8%A1%8C.png" alt></p>
<p>当我们运行一个<code>Java</code>程序<code>Hello.java</code>的时候，并没有运行经过<code>javac</code>编译产生的<code>Hello.class</code>文件，而是通过 <code>java</code> 来运行了 <code>Hello</code>，由此可见<code>.class</code>文件并不是能够直接被系统直接识别的二进制文件，而是在终端中通过调用<code>java</code>来运行一个编译后的文件的。</p>
<p>这是为什么呢 ？当我们运行<code>java</code>这个命令的时候，首先启动的是一个java程序，而这个java程序启动之后就是一个文章前面所提到的<code>一个JVM进程实例</code>。由此显而易见：真正处理java程序的是虚拟机。</p>
<p>当我们找到 <code>java</code> 这个命令所对应的文件夹时，可以看到他所存在路径：</p>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/java-bin%E6%96%87%E4%BB%B6-%E5%86%85%E5%AE%B9.png" alt></p>
<h1 id="1-class文件结构"><a href="#1-class文件结构" class="headerlink" title="1. class文件结构"></a>1. class文件结构</h1><p>我自己学习<code>JVM</code>是通过<code>《深入理解Java虚拟机 JVM高级特性与最佳实践》</code>这本书。当我写这篇文章时，是我读这本书的第3遍。前2此都是读到关于<code>class文件结构</code>时，阅读就越乱，索性就直接跳过了，结果就是对于<code>JVM</code>大致有了 一个了解，但是具体到<code>类加载</code>的详细细节以及其中的某一个变量的加载、初始化时，还是一头雾水。</p>
<p>对于我这样的结果书中的一句话就已经说明了这个问题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对数据结构方面的讲解不可避免的会比较枯燥，而这部分内容又是了解JVM重要的基础之一。如果想要深入的了解虚拟机，那么这部分是不可能不接触的。</span><br></pre></td></tr></table></figure>
<p>以下内容来自《深入理解Java虚拟机 JVM高级特性与最佳实践》：</p>
<p><strong>“</strong></p>
<h2 id="文件内容"><a href="#文件内容" class="headerlink" title="文件内容"></a>文件内容</h2><p>class文件是一种8位字节的<strong><code>二进制流文件</code></strong>， 各个数据项<strong><code>按顺序</code>**</strong><code>紧密的</code><strong>**<code>从前向后排列</code></strong>， 相邻的项之间<strong><code>没有间隙</code></strong>， 这样可以使得class文件非常紧凑， 体积轻巧， 可以被JVM快速的加载至内存， 并且占据较少的内存空间。 我们的Java源文件， 在被编译之后， 每个类（或者接口）都单独占据一个class文件， 并且类中的所有信息都会在class文件中有相应的描述， 由于class文件很灵活， 它甚至比Java源文件有着更强的描述能力。</p>
<p>class文件中的信息是一项一项排列的， 每项数据都有它的固定长度， 有的占一个字节， 有的占两个字节， 还有的占四个字节或8个字节， 数据项的不同长度分别用u1, u2, u4, u8表示， 分别表示一种数据项在class文件中占据一个字节， 两个字节， 4个字节和8个字节。 可以把u1, u2, u3, u4看做class文件数据项的“类型” 。</p>
<h2 id="文件格式"><a href="#文件格式" class="headerlink" title="文件格式"></a>文件格式</h2><p>class文件格式采用一种类似于C语言结构体的<code>伪结构体</code>来存储数据，这种<code>伪结构体</code>只有两种数据类型：<code>无符号数</code> + <code>表</code>。</p>
<ul>
<li><p><code>无符号数</code>：属于<code>基本数据类型</code>。</p>
<p>以<code>u1</code>, <code>u2</code>, <code>u4</code>, <code>u8</code>表示， 分别表示<code>一种数据项</code>在class文件中占据<code>一个字节</code>， <code>两个字节</code>， <code>4个字节</code>和<code>8个字节</code>的无符号数。无符号数用来描述：<code>数字</code>、<code>索引引用</code>、<code>数量值</code>或<code>按照UTF-8编码构成的字符串值</code>。</p>
</li>
<li><p><code>表</code>：由<code>多个无符号数</code>或<code>其他表作为数据项</code>构成的<code>复合数据类型</code>。</p>
<p>所有的表都习惯性用<code>_info</code>结尾。表用于描述有<code>层次关系</code>的复合数据类型。</p>
</li>
</ul>
<p>无论是<code>无符号数</code>还是<code>表</code>，当需要描述<code>同一类型但数量不定</code>的多个数据时，经常会使用一个<code>前置容量计数器</code>+<code>若干个连续的数据项</code>形式。此时称<code>这一连续的某一类型的数据</code>为<code>某一类型的数据集合</code>。</p>
<p>class文件格式:</p>
<table>
<thead>
<tr>
<th style="text-align:left">类型</th>
<th style="text-align:left">名称</th>
<th style="text-align:left">数量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">u4</td>
<td style="text-align:left">magic</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">minor_version</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">major_version</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">constant_pool_count</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">cp_info</td>
<td style="text-align:left">constant_pool</td>
<td style="text-align:left">constant_pool_count - 1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">access_flags</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">this_class</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">super_class</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">interfaces_count</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">interfaces</td>
<td style="text-align:left">interfaces_count</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">fields_count</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">field_info</td>
<td style="text-align:left">fields</td>
<td style="text-align:left">fields_count</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">methods_count</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">method_info</td>
<td style="text-align:left">methods</td>
<td style="text-align:left">methods_count</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">attribute_count</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">attribute_info</td>
<td style="text-align:left">attributes</td>
<td style="text-align:left">attributes_count</td>
</tr>
</tbody>
</table>
<p><strong>”</strong></p>
<p>一个class文件的实际格式（部分）：</p>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6%E9%83%A8%E5%88%86%E6%A0%BC%E5%BC%8F.png" alt></p>
<h2 id="探究开始"><a href="#探究开始" class="headerlink" title="探究开始"></a>探究开始</h2><ul>
<li>一个简单的java程序 </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class Hello &#123;</span><br><span class="line"></span><br><span class="line">    public static String str = &quot;Java Code&quot;;</span><br><span class="line">    public static final int currentCode = 18;</span><br><span class="line">    static &#123;</span><br><span class="line">        Person person = new Person();</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        String mainStr = &quot;this is main method&quot;;</span><br><span class="line">	</span><br><span class="line">        (&quot;Hello Word!&quot;);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">        System.out.println(mainStr);</span><br><span class="line">        System.out.println(currentCode);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>调用 <code>javac</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac Hello.java</span><br></pre></td></tr></table></figure>
<ul>
<li><p>调用  <a href="https://www.cnblogs.com/frinder6/p/5440173.html" target="_blank" rel="noopener">javap</a>  命令</p>
<p><code>javap</code>是 class文件<code>分解器</code>，可以反编译（即对javac编译的文件进行反编译），也可以查看java编译器生成的字节码。</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javap -v Hello</span><br></pre></td></tr></table></figure>
<p> 得到的结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">Classfile /Users/yannischeng/Projects_IDEA_Java/InnerClass/src/Hello.class</span><br><span class="line">  Last modified <span class="number">2018</span>-<span class="number">11</span>-<span class="number">21</span>; size <span class="number">703</span> bytes</span><br><span class="line">  MD5 checksum af24e8fdae56427e615d521bf93b4b6d</span><br><span class="line">  Compiled from <span class="string">"Hello.java"</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span></span><br><span class="line">  minor version: 0</span><br><span class="line">  major version: <span class="number">52</span></span><br><span class="line">  flags: ACC_PUBLIC, ACC_SUPER</span><br><span class="line">Constant pool:</span><br><span class="line">   #1 = Methodref          #12.#28        // java/lang/Object."&lt;init&gt;":()V</span><br><span class="line">   #2 = String             #29            // this is main method</span><br><span class="line">   #3 = Fieldref           #30.#31        // java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">   #4 = String             #32            // Hello Word!</span><br><span class="line">   #5 = Methodref          #33.#34        // java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">   #6 = Fieldref           #7.#35         // Hello.str:Ljava/lang/String;</span><br><span class="line">   #7 = Class              #36            // Hello</span><br><span class="line">   #8 = Methodref          #33.#37        // java/io/PrintStream.println:(I)V</span><br><span class="line">   #9 = String             #38            // Java Code</span><br><span class="line">  #10 = Class              #39            // Person</span><br><span class="line">  #11 = Methodref          #10.#28        // Person."&lt;init&gt;":()V</span><br><span class="line">  #12 = Class              #40            // java/lang/Object</span><br><span class="line">  #13 = Utf8               str</span><br><span class="line">  #14 = Utf8               Ljava/lang/String;</span><br><span class="line">  #15 = Utf8               currentCode</span><br><span class="line">  #16 = Utf8               I</span><br><span class="line">  #17 = Utf8               ConstantValue</span><br><span class="line">  #18 = Integer            18</span><br><span class="line">  #19 = Utf8               &lt;init&gt;</span><br><span class="line">  #20 = Utf8               ()V</span><br><span class="line">  #21 = Utf8               Code</span><br><span class="line">  #22 = Utf8               LineNumberTable</span><br><span class="line">  #23 = Utf8               main</span><br><span class="line">  #24 = Utf8               ([Ljava/lang/String;)V</span><br><span class="line">  #25 = Utf8               &lt;clinit&gt;</span><br><span class="line">  #26 = Utf8               SourceFile</span><br><span class="line">  #27 = Utf8               Hello.java</span><br><span class="line">  #28 = NameAndType        #19:#20        // "&lt;init&gt;":()V</span><br><span class="line">  #29 = Utf8               this is main method</span><br><span class="line">  #30 = Class              #41            // java/lang/System</span><br><span class="line">  #31 = NameAndType        #42:#43        // out:Ljava/io/PrintStream;</span><br><span class="line">  #32 = Utf8               Hello Word!</span><br><span class="line">  #33 = Class              #44            // java/io/PrintStream</span><br><span class="line">  #34 = NameAndType        #45:#46        // println:(Ljava/lang/String;)V</span><br><span class="line">  #35 = NameAndType        #13:#14        // str:Ljava/lang/String;</span><br><span class="line">  #36 = Utf8               Hello</span><br><span class="line">  #37 = NameAndType        #45:#47        // println:(I)V</span><br><span class="line">  #38 = Utf8               Java Code</span><br><span class="line">  #39 = Utf8               Person</span><br><span class="line">  #40 = Utf8               java/lang/Object</span><br><span class="line">  #41 = Utf8               java/lang/System</span><br><span class="line">  #42 = Utf8               out</span><br><span class="line">  #43 = Utf8               Ljava/io/PrintStream;</span><br><span class="line">  #44 = Utf8               java/io/PrintStream</span><br><span class="line">  #45 = Utf8               println</span><br><span class="line">  #46 = Utf8               (Ljava/lang/String;)V</span><br><span class="line">  #47 = Utf8               (I)V</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> java.lang.String str;</span><br><span class="line">    descriptor: Ljava/lang/String;</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">	</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> currentCode;</span><br><span class="line">    descriptor: I</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC, ACC_FINAL</span><br><span class="line">    ConstantValue: <span class="keyword">int</span> <span class="number">18</span></span><br><span class="line">	</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Hello</span><span class="params">()</span></span>;</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">1</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         1: invokespecial #1                  // Method java/lang/Object."&lt;init&gt;":()V</span><br><span class="line">         <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">1</span>: <span class="number">0</span></span><br><span class="line">	</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(java.lang.String[])</span></span>;</span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>, locals=<span class="number">2</span>, args_size=<span class="number">1</span></span><br><span class="line">         0: ldc           #2                  // String this is main method</span><br><span class="line">         <span class="number">2</span>: astore_1</span><br><span class="line">         3: getstatic     #3                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">         6: ldc           #4                  // String Hello Word!</span><br><span class="line">         8: invokevirtual #5                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">        11: getstatic     #3                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">        14: getstatic     #6                  // Field str:Ljava/lang/String;</span><br><span class="line">        17: invokevirtual #5                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">        20: getstatic     #3                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">        <span class="number">23</span>: aload_1</span><br><span class="line">        24: invokevirtual #5                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">        27: getstatic     #3                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">        <span class="number">30</span>: bipush        <span class="number">18</span></span><br><span class="line">        32: invokevirtual #8                  // Method java/io/PrintStream.println:(I)V</span><br><span class="line">        <span class="number">35</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">10</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">12</span>: <span class="number">3</span></span><br><span class="line">        line <span class="number">13</span>: <span class="number">11</span></span><br><span class="line">        line <span class="number">14</span>: <span class="number">20</span></span><br><span class="line">        line <span class="number">15</span>: <span class="number">27</span></span><br><span class="line">        line <span class="number">16</span>: <span class="number">35</span></span><br><span class="line">	</span><br><span class="line">  <span class="keyword">static</span> &#123;&#125;;</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>, locals=<span class="number">1</span>, args_size=<span class="number">0</span></span><br><span class="line">         0: ldc           #9                  // String Java Code</span><br><span class="line">         2: putstatic     #6                  // Field str:Ljava/lang/String;</span><br><span class="line">         5: new           #10                 // class Person</span><br><span class="line">         <span class="number">8</span>: dup</span><br><span class="line">         9: invokespecial #11                 // Method Person."&lt;init&gt;":()V</span><br><span class="line">        <span class="number">12</span>: astore_0</span><br><span class="line">        <span class="number">13</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">3</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">6</span>: <span class="number">5</span></span><br><span class="line">        line <span class="number">7</span>: <span class="number">13</span></span><br><span class="line">&#125;</span><br><span class="line">SourceFile: <span class="string">"Hello.java"</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>通过<code>十六进制编辑器</code>打开 <code>Hello.class</code> 文件</p>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B616%E8%BF%9B%E5%88%B6.png" alt></p>
</li>
</ul>
<h3 id="3-1-magic"><a href="#3-1-magic" class="headerlink" title="3.1 magic"></a>3.1 magic</h3><p>u4 magic = 0xCAFEBABE</p>
<p>作用：确定此文件是否是一个能够被虚拟机接受的class文件。除此外，很多文件也通过<code>magic</code>来进行身份的标识。</p>
<h3 id="3-2-版本"><a href="#3-2-版本" class="headerlink" title="3.2 版本"></a>3.2 版本</h3><p>u2 minor_version：此版本号<br>u2 major_version：主版本号 </p>
<h3 id="3-3-常量池"><a href="#3-3-常量池" class="headerlink" title="3.3 常量池"></a>3.3 常量池</h3><p>常量池可理解为是class文件中的<code>资源仓库</code>，是class文件中与其他文件关联最多的数据类型 ，也是class文件中占用空间最大的数据项目之一，同时也是class文件中第一个出现<code>表数据类型</code>的数据项目。</p>
<h4 id="常量池容量计数器"><a href="#常量池容量计数器" class="headerlink" title="常量池容量计数器"></a>常量池容量计数器</h4><p>u2 常量池容量计数器 ：因为常量池的数量是不固定的，同时此计数器的索引是从 <code>1</code> 开始的而不是<code>0</code>。</p>
<h4 id="存放内容："><a href="#存放内容：" class="headerlink" title="存放内容："></a>存放内容：</h4><ul>
<li>字面量（Literal）：类似于Java中的常量</li>
<li>符号引用（Symbolic References）：<ul>
<li>类和接口的全限定名（Full Qualified Name）</li>
<li>字段名称与描述（Descriptor）</li>
<li>方法的名称与描述</li>
</ul>
</li>
</ul>
<p><strong>关于<code>符号引用</code></strong></p>
<p> 因为JVM在加载class文件的时候进行的<code>动态连接</code>，也就是说在class文件中并没有保存各个方法、字段的的<code>最终内存地址</code>。因此，如果这些字段、方法的<code>符号引用</code>若是不经过<code>运行期转换</code>的话是无法得到<code>真正的内存地址入口</code>的，无法被虚拟机直接使用。</p>
<p> 于是当虚拟机运行时，需要从常量池中获得对应的符号引用，然后在类的创建或其他过程中将其对应到具体的内存地址之中 。</p>
<h3 id="常量池内容"><a href="#常量池内容" class="headerlink" title="常量池内容"></a>常量池内容</h3><p> 常量池中的每一项内容都是一个表，共有14种常量类型，每一种类型都有着自己的类型（具体参考《深入理解JVM》P172）。</p>
<p> <img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E5%B8%B8%E9%87%8F%E6%B1%A0-%E8%A1%A8.png" alt></p>
<h3 id="3-4-访问标志"><a href="#3-4-访问标志" class="headerlink" title="3.4 访问标志"></a>3.4 访问标志</h3><p><code>访问标志</code> 在 <code>常量池</code>接收之后出现，用于表示这个class文件是一个 <code>接口</code> 还是一个  <code>类</code>，是<code>public</code> 还是 <code>private</code>。如图：</p>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E8%AE%BF%E9%97%AE%E6%A0%87%E5%BF%97.png" alt></p>
<h3 id="3-5-类索引、父类索引、接口索引集合"><a href="#3-5-类索引、父类索引、接口索引集合" class="headerlink" title="3.5 类索引、父类索引、接口索引集合"></a>3.5 类索引、父类索引、接口索引集合</h3><p>此处：<code>父类索引</code>只有1个，<code>接口索引</code> 确是一个集合，可见Java的<code>单继承、多实现</code>的特点。</p>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E7%B1%BB%E3%80%81%E6%8E%A5%E5%8F%A3%E3%80%82%E7%88%B6%E7%B1%BB%E7%B4%A2%E5%BC%95.png" alt></p>
<h3 id="3-6-字段表集合"><a href="#3-6-字段表集合" class="headerlink" title="3.6 字段表集合"></a>3.6 字段表集合</h3><p><code>字段表（field_info）</code>是用来描述：<code>接口</code>或者<code>类</code>中声明<code>变量</code>。<br><code>字段（field）</code>包括：<code>类级别</code>以及<code>实例级别</code>中的变量，不包括在方法内部中声明的局部变量。</p>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E5%AD%97%E6%AE%B5%E8%A1%A8%E9%9B%86%E5%90%88.png" alt></p>
<p><strong>注：<code>字段</code>以及<code>方法</code>中的<code>描述符</code>：</strong></p>
<h4 id="符号含义："><a href="#符号含义：" class="headerlink" title="符号含义："></a>符号含义：</h4><ul>
<li><p><strong>常见类型：</strong></p>
<p>  |表示字符|含义|<br>  |:–|:–|<br>  |Z|基本类型 boolean|<br>  |B|基本类型 byte|<br>  |C|基本类型 char|<br>  |S|基本类型 short|<br>  |I|基本类型 int|<br>  |J|基本类型 long|<br>  |F|基本类型 float|<br>  |D|基本类型 double|<br>  |V|特殊类型 void|<br>  |L|对象类型 ，如：Ljava/lang/Object|</p>
</li>
<li><p><strong>数组类型：</strong></p>
<p>每一个纬度将使用一个<code>[</code>字符来表示。<br>如果是一维<code>java.lang.String[]</code>则为：<code>[Ljava/lang/String;</code>，二维<code>int[][]</code> 表示为<code>[[I</code></p>
</li>
<li><p><strong>描述符来描述方法：</strong></p>
<p>按照：<code>先参数列表，后返回值</code>的顺序来描述。<br>如：<code>void (java.lang.String[])</code>表示为：<code>([Ljava/lang/String;)V</code>；<code>void(int a)</code>表示为:<code>(I)V</code></p>
</li>
</ul>
<h4 id="字段表结构"><a href="#字段表结构" class="headerlink" title="字段表结构"></a>字段表结构</h4><table>
<thead>
<tr>
<th style="text-align:left">类型</th>
<th style="text-align:left">名称</th>
<th style="text-align:left">数量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">access_flags</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">name_index</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">descriptor_index</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">attribute_count</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">attribute_info</td>
<td style="text-align:left">attributes</td>
<td style="text-align:left">attributes_count</td>
</tr>
</tbody>
</table>
<h3 id="3-7-方法表集合"><a href="#3-7-方法表集合" class="headerlink" title="3.7 方法表集合"></a>3.7 方法表集合</h3><p> <img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E6%96%B9%E6%B3%95%E8%A1%A8.png" alt></p>
<h4 id="方法表结构"><a href="#方法表结构" class="headerlink" title="方法表结构"></a>方法表结构</h4><table>
<thead>
<tr>
<th style="text-align:left">类型</th>
<th style="text-align:left">名称</th>
<th style="text-align:left">数量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">access_flags</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">name_index</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">descriptor_index</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">u2</td>
<td style="text-align:left">attribute_count</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">attribute_info</td>
<td style="text-align:left">attributes</td>
<td style="text-align:left">attributes_count</td>
</tr>
</tbody>
</table>
<p>不同点：<code>访问标志（access_flags）</code>与<code>属性表集合(attribute_info)</code>不同</p>
<h4 id="特殊-方法体：Code"><a href="#特殊-方法体：Code" class="headerlink" title="特殊-方法体：Code"></a>特殊-方法体：Code</h4><p>在方法表结构中我们仅仅是看到了关于方法的<code>描述</code>，但是却未看到<code>具体方法体</code>，那么去哪了呢？</p>
<p><strong>答案是：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Java文件中的方法体，在经过编译器编译成字节码文件后，存放在方法体中一个名为“Code”的属性里面。</span><br></pre></td></tr></table></figure>
<p>在字节码中如下图所示：</p>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E6%96%B9%E6%B3%95%E4%BD%93.png" alt></p>
<p>经过<code>javap</code>处理后，如下图所示：</p>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/class%E6%96%87%E4%BB%B6-%E6%96%B9%E6%B3%95%E4%BD%93-javap.png" alt></p>
<p><strong>Code</strong> 是class文件中一个重要的属性，如果把一个Java程序中的信息分为<code>代码（Code，方法体中的代码）</code>和<code>元数据（类、字段、方法定义及其他描述信息）</code>2个部分，那么在class文件中：<code>Code</code>用于描述代码，<code>其他所有数据项目</code>描述元数据。</p>
<p><strong>Code</strong> 属性是学习关于<code>字节码执行引擎</code>内容的必要基础。</p>
<h4 id="符号含义"><a href="#符号含义" class="headerlink" title="符号含义"></a>符号含义</h4><table>
<thead>
<tr>
<th>名称</th>
<th>样式</th>
</tr>
</thead>
<tbody>
<tr>
<td>类构造器</td>
<td><code>&lt;clinit&gt;</code></td>
</tr>
<tr>
<td>实例构造器</td>
<td><code>&lt;init&gt;</code></td>
</tr>
</tbody>
</table>
<h3 id="3-8-属性表集合"><a href="#3-8-属性表集合" class="headerlink" title="3.8 属性表集合"></a>3.8 属性表集合</h3><p>由于属性太多，具体参考《深入理解JVM》P180</p>
<ul>
<li><p><strong>LineNumberTable</strong>属性：描述<code>Java源码行号</code>与<code>字节码行号</code>之间的<code>对应关系</code>。</p>
<p>属于<code>非运行时必需属性</code>，默认生成。所以在运行<code>javac</code>命令时，可以通过</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-g:none</span><br></pre></td></tr></table></figure>
<p> 或者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-g:lines</span><br></pre></td></tr></table></figure>
<p> 来选择是否要生成此项信息。如果不生成<code>LineNumberTable</code>属性不会影响程序运行，但是存在的问题是：</p>
<ul>
<li><strong>抛出异常时</strong>，堆栈中将不会显示 <strong>出错的行号</strong></li>
<li><strong>调试程序时</strong>：<strong>无法按照源码设置断点</strong></li>
</ul>
<ul>
<li><p><strong>LocalVariableTable</strong>属性：描述<code>栈帧</code>中<code>局部变量表</code>中的变量与<code>Java源码</code>中定义的变量之间的关系。</p>
<p>属于<code>非运行时必需属性</code>，默认生成。如果不生成不会影响程序运行，会导致：</p>
<ul>
<li>他人在调用其所在的方法参数名丢失，但不影响程序运行</li>
<li>在进行断点调试时无法根据参数名从上下文获取参数值。</li>
</ul>
</li>
<li><p><strong>SourceFile</strong>属性：记录生成这个class文件所对应的源码的文件名称。</p>
<p>属于<code>非运行时必需属性</code>，默认生成。如果不生成不会影响程序运行，会导致：</p>
<ul>
<li>程序出现异常，在堆栈中将不会显示出错代码所属的文件名称。</li>
</ul>
</li>
<li><p><strong>ConstantValue</strong>属性：通知虚拟机自动为<code>静态变量</code>赋值。只有被<code>static关键字</code>修饰的变量（类变量）才能使用这项属性。</p>
<p><strong>赋值差异：</strong></p>
<ul>
<li>非static类型变量（实例变量）的赋值是在实例构造器<code>&lt;init&gt;</code> 方法中进行的</li>
<li><p>static类型变量（类变量）的赋值方式有2种（由javac编译器限制）：</p>
<ol>
<li>在类构造器<code>&lt;clinit&gt;</code>方法中：一个变量未被<code>final</code>关键字修饰，或者数据类型非<code>基本数据类型</code>或者<code>String</code></li>
<li>使用<code>ConstantValue</code>属性：一个变量由<code>final</code>和<code>static</code>2个关键字同时修饰，且数据类型为<code>基本数据类型</code>或者<code>String</code></li>
</ol>
</li>
</ul>
</li>
<li><p><strong>innerClasses</strong>属性：记录内部类与宿主类之间的关联。</p>
</li>
</ul>
<h1 id="2-JVM字节码指令"><a href="#2-JVM字节码指令" class="headerlink" title="2. JVM字节码指令"></a>2. JVM字节码指令</h1><p>字节码指令是一个字节长度的，分为：<code>操作码</code>+<code>操作数</code>。<br>由于JVM是面向<code>操作数栈</code>而不是<code>寄存器</code>的架构，所以大多数指令只有<code>操作码</code>而没有<code>操作数</code>。</p>
<p>具体指令查看：《深入理解JVM》P199-P206</p>

      
    </div>
    
    
    

    

    


    <footer class="post-footer">
      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/记一次翻车-个人博客图床问题/" rel="next" title="记一次翻车-个人博客图床问题">
                <i class="fa fa-chevron-left"></i> 记一次翻车-个人博客图床问题
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/JVM理解-javac源码文件/" rel="prev" title="JVM理解-javac源码文件">
                JVM理解-javac源码文件 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="http://oy991qm3u.bkt.clouddn.com/%E6%A2%B5%E9%AB%98.gif" alt="YannisCheng">
            
              <p class="site-author-name" itemprop="name">YannisCheng</p>
              <p class="site-description motion-element" itemprop="description">不必一味的讨好别人，每个人都有自己的活法。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">182</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">75</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/YannisCheng" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:cwj1714@163.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-JVM是什么"><span class="nav-number">1.1.</span> <span class="nav-text">1. JVM是什么</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-进程与JVM"><span class="nav-number">1.2.</span> <span class="nav-text">2. 进程与JVM</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一个Java程序的运行"><span class="nav-number">1.2.1.</span> <span class="nav-text">一个Java程序的运行</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1-class文件结构"><span class="nav-number">2.</span> <span class="nav-text">1. class文件结构</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#文件内容"><span class="nav-number">2.1.</span> <span class="nav-text">文件内容</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件格式"><span class="nav-number">2.2.</span> <span class="nav-text">文件格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#探究开始"><span class="nav-number">2.3.</span> <span class="nav-text">探究开始</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-magic"><span class="nav-number">2.3.1.</span> <span class="nav-text">3.1 magic</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-版本"><span class="nav-number">2.3.2.</span> <span class="nav-text">3.2 版本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-常量池"><span class="nav-number">2.3.3.</span> <span class="nav-text">3.3 常量池</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#常量池容量计数器"><span class="nav-number">2.3.3.1.</span> <span class="nav-text">常量池容量计数器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#存放内容："><span class="nav-number">2.3.3.2.</span> <span class="nav-text">存放内容：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常量池内容"><span class="nav-number">2.3.4.</span> <span class="nav-text">常量池内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-访问标志"><span class="nav-number">2.3.5.</span> <span class="nav-text">3.4 访问标志</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-类索引、父类索引、接口索引集合"><span class="nav-number">2.3.6.</span> <span class="nav-text">3.5 类索引、父类索引、接口索引集合</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-字段表集合"><span class="nav-number">2.3.7.</span> <span class="nav-text">3.6 字段表集合</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#符号含义："><span class="nav-number">2.3.7.1.</span> <span class="nav-text">符号含义：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#字段表结构"><span class="nav-number">2.3.7.2.</span> <span class="nav-text">字段表结构</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-方法表集合"><span class="nav-number">2.3.8.</span> <span class="nav-text">3.7 方法表集合</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#方法表结构"><span class="nav-number">2.3.8.1.</span> <span class="nav-text">方法表结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#特殊-方法体：Code"><span class="nav-number">2.3.8.2.</span> <span class="nav-text">特殊-方法体：Code</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#符号含义"><span class="nav-number">2.3.8.3.</span> <span class="nav-text">符号含义</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-8-属性表集合"><span class="nav-number">2.3.9.</span> <span class="nav-text">3.8 属性表集合</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-JVM字节码指令"><span class="nav-number">3.</span> <span class="nav-text">2. JVM字节码指令</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2016 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YannisCheng</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">423.7k</span>
  
</div>













        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.3"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.3"></script>


  


<script type="text/javascript" color="18,146,19" opacity="0.7" zindex="-1" count="0" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script>

</body>
</html>
