<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">






  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Android,Gradle," />










<meta name="description" content="Groovy：http://docs.groovy-lang.org/Gradle DSL: https://docs.gradle.org/current/javadoc/org/gradle/api/Project.htmlAndroid DSL 与 Task: http://google.github.io/android-gradle-dsl/current/index.html">
<meta name="keywords" content="Android,Gradle">
<meta property="og:type" content="article">
<meta property="og:title" content="Gradle与Android">
<meta property="og:url" content="http://yannischeng.com/Gradle与Android/index.html">
<meta property="og:site_name" content="YannisCheng&#39;s Technology Blogs">
<meta property="og:description" content="Groovy：http://docs.groovy-lang.org/Gradle DSL: https://docs.gradle.org/current/javadoc/org/gradle/api/Project.htmlAndroid DSL 与 Task: http://google.github.io/android-gradle-dsl/current/index.html">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://oy991qm3u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-22%2021.03.22.png">
<meta property="og:image" content="http://oy991qm3u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-22%2021.50.12.png">
<meta property="og:image" content="http://oy991qm3u.bkt.clouddn.com/gradle-%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA%E8%AF%B4%E6%98%8E.png">
<meta property="og:image" content="http://oy991qm3u.bkt.clouddn.com/commandLineTutorialTasks.png">
<meta property="og:image" content="http://oy991qm3u.bkt.clouddn.com/project-structure_2x.png">
<meta property="og:image" content="http://oy991qm3u.bkt.clouddn.com/Project-View-Android.png">
<meta property="og:image" content="http://oy991qm3u.bkt.clouddn.com/Gradle-window-signingReport.png">
<meta property="og:image" content="http://oy991qm3u.bkt.clouddn.com/build-process_2x.png">
<meta property="og:image" content="http://oy991qm3u.bkt.clouddn.com/3606778-b978b976f8d0f591.png">
<meta property="og:image" content="http://oy991qm3u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-07-14%2011.14.24.png">
<meta property="og:updated_time" content="2018-07-15T02:04:15.139Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Gradle与Android">
<meta name="twitter:description" content="Groovy：http://docs.groovy-lang.org/Gradle DSL: https://docs.gradle.org/current/javadoc/org/gradle/api/Project.htmlAndroid DSL 与 Task: http://google.github.io/android-gradle-dsl/current/index.html">
<meta name="twitter:image" content="http://oy991qm3u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-22%2021.03.22.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yannischeng.com/Gradle与Android/"/>





  <title>Gradle与Android | YannisCheng's Technology Blogs</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">YannisCheng's Technology Blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">不必一味的讨好别人，每个人都有自己的活法。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yannischeng.com/Gradle与Android/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YannisCheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://oy991qm3u.bkt.clouddn.com/%E6%A2%B5%E9%AB%98.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YannisCheng's Technology Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Gradle与Android</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-22T11:43:56+08:00">
                2018-05-22
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-07-15T10:04:15+08:00">
                2018-07-15
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  8,624 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  36 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    

    
        <div class="post-tags">
          
            <a href="/tags/Android/" rel="tag"># Android</a>
          
            <a href="/tags/Gradle/" rel="tag"># Gradle</a>
          
        </div>
      

    
    
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    YannisCheng
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://yannischeng.com/Gradle与Android/" title="Gradle与Android">http://yannischeng.com/Gradle与Android/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    尊重个人劳动成果，转载请注明出处。 ─=≡Σ(((つ•̀ω•́)つ))
  </li>
</ul>

      </div>
    



    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <blockquote>
<p>Groovy：<a href="http://docs.groovy-lang.org/" target="_blank" rel="external">http://docs.groovy-lang.org/</a><br>Gradle DSL: <a href="https://docs.gradle.org/current/javadoc/org/gradle/api/Project.html" target="_blank" rel="external">https://docs.gradle.org/current/javadoc/org/gradle/api/Project.html</a><br>Android DSL 与 Task: <a href="http://google.github.io/android-gradle-dsl/current/index.html" target="_blank" rel="external">http://google.github.io/android-gradle-dsl/current/index.html</a></p>
</blockquote>
<a id="more"></a>
<ul>
<li><strong>关键词：</strong> <strong>Android、Groovy、DSL语言、Gradle</strong></li>
<li><p><strong>关系：</strong><br><strong>-&gt;</strong> Android采用Gradle作为首选的构建自动化系统，使用Gradle强大的依赖关系管理功能<br><strong>-&gt;</strong> Gradle基于Groovy（一种用于编写Gradle的脚本语言），是一个<strong>开源构建自动化系统</strong>，它引入了基于Groovy的领域特定语言（DSL）来配置项目<br><strong>-&gt;</strong> Groovy是一种运行在JVM虚拟机上的脚本语言，能够与Java语言无缝结合。</p>
</li>
<li><p><strong>区分：<code>Android Plugin 版本</code> 和 <code>Gradle版本</code></strong></p>
</li>
<li><p><strong>Gradle插件 在Android中的用处</strong>：</p>
<ul>
<li>插件化 VirtualAPK</li>
<li>热修复 Tinker、Robust</li>
<li>构建系统：多渠道打包</li>
<li>Gradle插件</li>
</ul>
</li>
</ul>
<h1 id="1-Gradle概述"><a href="#1-Gradle概述" class="headerlink" title="1. Gradle概述"></a>1. Gradle概述</h1><blockquote>
<p>参考：<a href="https://docs.gradle.org/current/userguide/installation.html" target="_blank" rel="external">https://docs.gradle.org/current/userguide/installation.html</a></p>
</blockquote>
<h2 id="1-1-安装"><a href="#1-1-安装" class="headerlink" title="1.1 安装"></a>1.1 安装</h2><h3 id="1-1-1-先决条件"><a href="#1-1-1-先决条件" class="headerlink" title="1.1.1 先决条件"></a>1.1.1 先决条件</h3><p>Gradle可在所有主要操作系统上运行，并且只需要Java JDK 7或更高版本即可运行。检查，运行<code>java -version</code>。你应该看到这样的东西：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">❯java -version java version“1.8.0_151” </div><div class="line">Java™SE运行时环境（build 1.8.0_151-b12）</div><div class="line">Java HotSpot™64位服务器虚拟机（内置版本25.151-b12，混合模式）</div></pre></td></tr></table></figure>
<p>Gradle自带Groovy库，因此Groovy不需要安装。Gradle将忽略任何现有的Groovy安装。<br>Gradle使用它在您的路径中找到的任何JDK。或者，您可以将JAVA_HOME环境变量设置为指向所需JDK的安装目录。</p>
<h3 id="1-1-2-安装"><a href="#1-1-2-安装" class="headerlink" title="1.1.2 安装"></a>1.1.2 安装</h3><p>通过 <code>homebrew</code> 安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install gradle</div></pre></td></tr></table></figure>
<h3 id="1-1-3-验证安装"><a href="#1-1-3-验证安装" class="headerlink" title="1.1.3 验证安装"></a>1.1.3 验证安装</h3><p>输入命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle -v</div></pre></td></tr></table></figure>
<p>得到的结果，如果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">Welcome to Gradle 4.7!</div><div class="line"></div><div class="line">Here are the highlights of this release:</div><div class="line"> - Incremental annotation processing</div><div class="line"> - JDK 10 support</div><div class="line"> - Grouped non-interactive console logs</div><div class="line"> - Failed tests are re-run first for quicker feedback</div><div class="line"></div><div class="line">For more details see https://docs.gradle.org/4.7/release-notes.html</div><div class="line"></div><div class="line"></div><div class="line">------------------------------------------------------------</div><div class="line">Gradle 4.7</div><div class="line">------------------------------------------------------------</div><div class="line"></div><div class="line">Build time:   2018-04-18 09:09:12 UTC</div><div class="line">Revision:     b9a962bf70638332300e7f810689cb2febbd4a6c</div><div class="line"></div><div class="line">Groovy:       2.4.12</div><div class="line">Ant:          Apache Ant(TM) version 1.9.9 compiled on February 2 2017</div><div class="line">JVM:          1.8.0_131 (Oracle Corporation 25.131-b11)</div><div class="line">OS:           Mac OS X 10.13.4 x86_64</div></pre></td></tr></table></figure>
<p>则表示安装成功。</p>
<h2 id="1-2-创建新的Gradle项目"><a href="#1-2-创建新的Gradle项目" class="headerlink" title="1.2 创建新的Gradle项目"></a>1.2 创建新的Gradle项目</h2><h3 id="1-2-1-创建一个新的目录"><a href="#1-2-1-创建一个新的目录" class="headerlink" title="1.2.1 创建一个新的目录"></a>1.2.1 创建一个新的目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir Gradle_Projects</div></pre></td></tr></table></figure>
<p>进入新创建的目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd Gradle_Projects/</div></pre></td></tr></table></figure>
<h3 id="1-2-2-初始化项目"><a href="#1-2-2-初始化项目" class="headerlink" title="1.2.2 初始化项目"></a>1.2.2 初始化项目</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle init</div></pre></td></tr></table></figure>
<p>结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Starting a Gradle Daemon (subsequent builds will be faster)</div><div class="line"></div><div class="line">BUILD SUCCESSFUL in 3s</div><div class="line">2 actionable tasks: 2 executed</div></pre></td></tr></table></figure>
<p>表示初始化成功。</p>
<p>初始化成功后，项目的目录及文件功能说明：</p>
<p><img src="http://oy991qm3u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-22%2021.03.22.png" alt=""></p>
<h3 id="1-2-3-创建一个新任务"><a href="#1-2-3-创建一个新任务" class="headerlink" title="1.2.3 创建一个新任务"></a>1.2.3 创建一个新任务</h3><p>Gradle提供了用于通过基于Groovy或Kotlin的DSL创建和配置任务的API。</p>
<ul>
<li>在项目的“根目录”下创建一个文件夹“src”</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir src</div></pre></td></tr></table></figure>
<p>并进入此文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd src/</div></pre></td></tr></table></figure>
<ul>
<li><p>在新创建的“src”目录下创建一个新文件“myfile.txt”，并写入“Hello,Word !”：</p>
</li>
<li><p>在项目配置脚本文件<code>build.gradle</code>中，定义一个<code>copy</code>方法，具体为：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">task copy(type: Copy, group: &quot;Custom&quot;, description: &quot;Copies sources to the dest directory&quot;) &#123;</div><div class="line">    from &quot;src&quot;</div><div class="line">    into &quot;dest&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>在项目的“根目录”下执行 <code>copy</code> 方法的命令：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./gradlew copy</div></pre></td></tr></table></figure>
<p>若显示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">BUILD SUCCESSFUL in 10m 11s</div><div class="line">1 actionable task: 1 executed</div></pre></td></tr></table></figure>
<p>则表示任务添加成功。成功之后的项目树结构为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Gradle_Projects</div><div class="line">├── Gradle_Projects</div><div class="line">├── build.gradle</div><div class="line">├── dest</div><div class="line">│   └── myfile.txt</div><div class="line">├── gradle</div><div class="line">│   └── wrapper</div><div class="line">│       ├── gradle-wrapper.jar</div><div class="line">│       └── gradle-wrapper.properties</div><div class="line">├── gradlew</div><div class="line">├── gradlew.bat</div><div class="line">├── settings.gradle</div><div class="line">└── src</div><div class="line">    └── myfile.txt</div></pre></td></tr></table></figure>
<p><strong>注意：本人在执行 <code>copy</code> 方法命令时，并没有直接显示结果，而是先下载了一个gradle-4.7-bin.zip文件</strong></p>
<h3 id="1-2-4-应用一个插件"><a href="#1-2-4-应用一个插件" class="headerlink" title="1.2.4 应用一个插件"></a>1.2.4 应用一个插件</h3><p>Gradle包含一系列插件，Gradle插件门户中提供了许多更多的插件。插件中包含的其中一个插件就是base插件。结合调用的核心类型Zip，可以使用配置的名称和位置创建项目的zip存档。</p>
<p>使用语法将base插件添加到build.gradle文件中plugins。<strong>确保plugins {}在文件顶部添加该块（否则失败）</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">plugins &#123;</div><div class="line">    id &quot;base&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>现在添加一个从该src目录创建一个zip存档的任务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">task zip(type: Zip, group: &quot;Archive&quot;, description: &quot;Archives sources in a zip file&quot;) &#123;</div><div class="line">    from &quot;src&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>若显示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">BUILD SUCCESSFUL in 0s</div><div class="line">1 actionable task: 1 executed</div></pre></td></tr></table></figure>
<p>则表示任务执行成功，文件树为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Gradle_Projects</div><div class="line">├── Gradle_Projects</div><div class="line">├── build</div><div class="line">│   └── distributions</div><div class="line">│       └── Gradle_Projects.zip</div><div class="line">├── build.gradle</div><div class="line">├── dest</div><div class="line">│   └── myfile.txt</div><div class="line">├── gradle</div><div class="line">│   └── wrapper</div><div class="line">│       ├── gradle-wrapper.jar</div><div class="line">│       └── gradle-wrapper.properties</div><div class="line">├── gradlew</div><div class="line">├── gradlew.bat</div><div class="line">├── settings.gradle</div><div class="line">└── src</div><div class="line">    └── myfile.txt</div></pre></td></tr></table></figure>
<p>此任务是将 <code>src</code> 文件夹中的 <code>所有文件</code> 打包。zip包中的内容为：</p>
<p><img src="http://oy991qm3u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-22%2021.50.12.png" alt=""></p>
<h3 id="1-2-5-发现更多的可用-task"><a href="#1-2-5-发现更多的可用-task" class="headerlink" title="1.2.5 发现更多的可用 task"></a>1.2.5 发现更多的可用 <code>task</code></h3><p>执行命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./gradlew tasks</div></pre></td></tr></table></figure>
<p>结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line">------------------------------------------------------------</div><div class="line">All tasks runnable from root project</div><div class="line">------------------------------------------------------------</div><div class="line"></div><div class="line">Android tasks</div><div class="line">-------------</div><div class="line">androidDependencies - Displays the Android dependencies of the project.</div><div class="line">signingReport - Displays the signing info for each variant.</div><div class="line">sourceSets - Prints out all the source sets defined in this project.</div><div class="line"></div><div class="line">Build tasks</div><div class="line">-----------</div><div class="line">assemble - Assembles all variants of all applications and secondary packages.</div><div class="line">assembleAndroidTest - Assembles all the Test applications.</div><div class="line">assembleDebug - Assembles all Debug builds.</div><div class="line">assembleRelease - Assembles all Release builds.</div><div class="line">build - Assembles and tests this project.</div><div class="line">buildDependents - Assembles and tests this project and all projects that depend on it.</div><div class="line">buildNeeded - Assembles and tests this project and all projects it depends on.</div><div class="line">clean - Deletes the build directory.</div><div class="line">cleanBuildCache - Deletes the build cache directory.</div><div class="line">compileDebugAndroidTestSources</div><div class="line">compileDebugSources</div><div class="line">compileDebugUnitTestSources</div><div class="line">compileReleaseSources</div><div class="line">compileReleaseUnitTestSources</div><div class="line">mockableAndroidJar - Creates a version of android.jar that&apos;s suitable for unit tests.</div><div class="line"></div><div class="line">Build Setup tasks</div><div class="line">-----------------</div><div class="line">init - Initializes a new Gradle build.</div><div class="line">wrapper - Generates Gradle wrapper files.</div><div class="line"></div><div class="line">Help tasks</div><div class="line">----------</div><div class="line">buildEnvironment - Displays all buildscript dependencies declared in root project &apos;2018-07&apos;.</div><div class="line">components - Displays the components produced by root project &apos;2018-07&apos;. [incubating]</div><div class="line">dependencies - Displays all dependencies declared in root project &apos;2018-07&apos;.</div><div class="line">dependencyInsight - Displays the insight into a specific dependency in root project &apos;2018-07&apos;.</div><div class="line">dependentComponents - Displays the dependent components of components in root project &apos;2018-07&apos;. [incubating]</div><div class="line">help - Displays a help message.</div><div class="line">model - Displays the configuration model of root project &apos;2018-07&apos;. [incubating]</div><div class="line">projects - Displays the sub-projects of root project &apos;2018-07&apos;.</div><div class="line">properties - Displays the properties of root project &apos;2018-07&apos;.</div><div class="line">tasks - Displays the tasks runnable from root project &apos;2018-07&apos; (some of the displayed tasks may belong to subprojects).</div><div class="line"></div><div class="line">Install tasks</div><div class="line">-------------</div><div class="line">installDebug - Installs the Debug build.</div><div class="line">installDebugAndroidTest - Installs the android (on device) tests for the Debug build.</div><div class="line">uninstallAll - Uninstall all applications.</div><div class="line">uninstallDebug - Uninstalls the Debug build.</div><div class="line">uninstallDebugAndroidTest - Uninstalls the android (on device) tests for the Debug build.</div><div class="line">uninstallRelease - Uninstalls the Release build.</div><div class="line"></div><div class="line">Verification tasks</div><div class="line">------------------</div><div class="line">check - Runs all checks.</div><div class="line">connectedAndroidTest - Installs and runs instrumentation tests for all flavors on connected devices.</div><div class="line">connectedCheck - Runs all device checks on currently connected devices.</div><div class="line">connectedDebugAndroidTest - Installs and runs the tests for debug on connected devices.</div><div class="line">deviceAndroidTest - Installs and runs instrumentation tests using all Device Providers.</div><div class="line">deviceCheck - Runs all device checks using Device Providers and Test Servers.</div><div class="line">lint - Runs lint on all variants.</div><div class="line">lintDebug - Runs lint on the Debug build.</div><div class="line">lintRelease - Runs lint on the Release build.</div><div class="line">lintVitalRelease - Runs lint on just the fatal issues in the release build.</div><div class="line">test - Run unit tests for all variants.</div><div class="line">testDebugUnitTest - Run unit tests for the debug build.</div><div class="line">testReleaseUnitTest - Run unit tests for the release build.</div><div class="line"></div><div class="line">To see all tasks and more detail, run gradlew tasks --all</div><div class="line"></div><div class="line">To see more detail about a task, run gradlew help --task &lt;task&gt;</div></pre></td></tr></table></figure>
<p><strong>说明：</strong></p>
<p><code>task任务参数</code> 与 <code>build.gradle</code> 文件中的代码对比：</p>
<p><img src="http://oy991qm3u.bkt.clouddn.com/gradle-%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA%E8%AF%B4%E6%98%8E.png" alt=""></p>
<h2 id="1-3-命令"><a href="#1-3-命令" class="headerlink" title="1.3 命令"></a>1.3 命令</h2><h3 id="1-3-1-一般命令："><a href="#1-3-1-一般命令：" class="headerlink" title="1.3.1 一般命令："></a>1.3.1 一般命令：</h3><ul>
<li>Gradle命令符合以下结构，在任务名称之前和之后允许选项：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle [taskName ...] [--option-name ...]</div></pre></td></tr></table></figure>
<p>如果指定了<strong>多个任务</strong>，则应该用<strong>空格分隔</strong>。</p>
<ul>
<li>接受值的选项可以在选项和参数之间使用或不使用<code>=</code>指定; 然而，推荐使用<code>=</code>。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">--console=plain</div></pre></td></tr></table></figure>
<ul>
<li>启用行为的选项具有长形式的选项，而用<code>--no-</code>指定的反向选项。 以下是相对的命令。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">--build-cache</div><div class="line">--no-build-cache</div></pre></td></tr></table></figure>
<p>许多长期形式的期权都有相当于短期期权的选择。 以下是等同的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">--help</div><div class="line">-h</div></pre></td></tr></table></figure>
<h3 id="1-3-2-执行任务"><a href="#1-3-2-执行任务" class="headerlink" title="1.3.2 执行任务"></a>1.3.2 执行任务</h3><ul>
<li>运行任务及。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle myTask</div></pre></td></tr></table></figure>
<ul>
<li>在<strong>多项目构建</strong>中执行任务</li>
</ul>
<p>在多项目构建中，可以使用 <code>:</code> 分隔 <strong>子项目名称</strong> 和 <strong>任务名称</strong> 来执行子项目任务。 从根项目运行时，以下内容得到的结果是等价的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gradle :mySubproject:taskName</div><div class="line">gradle mySubproject:taskName</div></pre></td></tr></table></figure>
<ul>
<li>也可以<strong>仅使用任务名称</strong>为所有子项目运行任务。 例如，这将从根项目目录中调用时为所有子项目运行“测试”任务。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle test</div></pre></td></tr></table></figure>
<ul>
<li>从子项目中调用Gradle时，应该省略项目名称：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd mySubproject</div><div class="line">gradle taskName</div></pre></td></tr></table></figure>
<ul>
<li>执行多任务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle test deploy</div></pre></td></tr></table></figure>
<ul>
<li><strong>排除</strong>执行任务中的引用任务</li>
</ul>
<p>您可以使用<code>-x</code>或<code>--exclude-task</code>命令行选项排除正在执行的任务，并提供要排除的任务的名称。</p>
<p><img src="http://oy991qm3u.bkt.clouddn.com/commandLineTutorialTasks.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">gradle dist --exclude-task test</div><div class="line"></div><div class="line">&gt; Task :compile</div><div class="line">compiling source</div><div class="line"></div><div class="line">&gt; Task :dist</div><div class="line">building the distribution</div><div class="line"></div><div class="line">BUILD SUCCESSFUL in 0s</div><div class="line">2 actionable tasks: 2 executed</div></pre></td></tr></table></figure>
<p>您可以看到 <code>test</code> 任务未执行，即使它是 <code>dist</code> 任务的依赖项。 测试任务的依赖项（如compileTest）也不会执行。 另一个任务所需的测试依赖关系，如编译，仍然执行。</p>
<ul>
<li><strong>强制</strong>任务执行</li>
</ul>
<p>您可以使用 <code>--rerun-tasks</code> 选项强制Gradle执行所有忽略最新检查的任务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle test --rerun-tasks</div></pre></td></tr></table></figure>
<ul>
<li><strong>发生故障</strong>时继续构建</li>
</ul>
<p>默认情况下，一旦任何任务失败，Gradle将中止执行并使构建失败。 这样可以尽快完成构建，但隐藏了可能发生的其他故障。 为了在单个构建执行中发现尽可能多的失败，可以使用 <code>--continue</code> 选项。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle test --continue</div></pre></td></tr></table></figure>
<p>当使用<code>--continue</code>执行时，Gradle将执行每个要执行的任务，而该任务的所有依赖关系完成时不会失败，而不会在遇到第一个失败时立即停止。 每次遇到的故障将在构建结束时报告。</p>
<p>如果任务失败，则任何依赖它的后续任务将不会执行。 例如，如果测试中的代码出现编译失败，测试将不会运行; 因为测试任务将取决于编译任务（直接或间接）。</p>
<ul>
<li>任务名称缩写</li>
</ul>
<p>在命令行中指定任务时，不必提供任务的全名。 您只需提供足够的任务名称即可唯一标识任务。 举例来说，Gradle可能足以让Gradle识别检查任务。</p>
<p>您还可以缩写骆驼案件任务名称中的每个单词。 例如，您可以通过运行gradle compTest或gradle cT来执行任务compileTest。</p>
<p>示例：缩写骆驼案例任务名称</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle cT</div></pre></td></tr></table></figure>
<p>您还可以将这些缩写与-x命令行选项一起使用。</p>
<h3 id="1-3-3-常用-Task"><a href="#1-3-3-常用-Task" class="headerlink" title="1.3.3 常用 Task"></a>1.3.3 常用 Task</h3><p>以下是由<strong>内置</strong>和<strong>最主要的Gradle插件</strong>应用的任务约定。</p>
<ul>
<li>计算所有输出</li>
</ul>
<p>在Gradle构建中，通常build指定汇编所有输出并运行所有检查。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle build</div></pre></td></tr></table></figure>
<ul>
<li><strong>运行</strong>应用程序</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle run</div></pre></td></tr></table></figure>
<ul>
<li>运行所有<strong>检查</strong></li>
</ul>
<p>所有验证任务都是常见的，包括测试和测试，都是使用check任务执行的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle check</div></pre></td></tr></table></figure>
<ul>
<li>清洁输出</li>
</ul>
<p>您可以使用clean任务删除构建目录的内容，但这样做会导致预先计算的输出丢失，从而导致后续任务执行的额外构建时间大大增加。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle clean</div></pre></td></tr></table></figure>
<h2 id="1-3-4-项目信息-Task"><a href="#1-3-4-项目信息-Task" class="headerlink" title="1.3.4 项目信息 Task"></a>1.3.4 项目信息 Task</h2><p>Gradle提供了几个内置任务，这些任务显示了构建的特定细节。这对理解构建的结构和依赖关系以及调试问题很有用。</p>
<ul>
<li>列出 项目</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle projects</div></pre></td></tr></table></figure>
<p>结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; Task :projects</div><div class="line"></div><div class="line">------------------------------------------------------------</div><div class="line">Root project</div><div class="line">------------------------------------------------------------</div><div class="line"></div><div class="line">Root project &apos;HelloGradle&apos;</div><div class="line">\--- Project &apos;:app&apos;</div></pre></td></tr></table></figure>
<ul>
<li>列出 task -1：  <strong>:app:tasks</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle :app:tasks</div></pre></td></tr></table></figure>
<ul>
<li>列出 task -2： <strong>gradle tasks</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle tasks</div></pre></td></tr></table></figure>
<ul>
<li>列出 task -3：<strong>gradle tasks –all</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle tasks --all</div></pre></td></tr></table></figure>
<ul>
<li>显示 task 使用详情</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle help --task check</div></pre></td></tr></table></figure>
<p>结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; Task :help</div><div class="line">Detailed task information for check // 详细任务信息</div><div class="line"></div><div class="line">Path // 路径</div><div class="line">     :app:check</div><div class="line"></div><div class="line">Type // 类型</div><div class="line">     Task (org.gradle.api.Task)</div><div class="line"></div><div class="line">Description // 描述</div><div class="line">     Runs all checks.</div><div class="line"></div><div class="line">Group // 组</div><div class="line">     verification</div></pre></td></tr></table></figure>
<ul>
<li>列出项目依赖关系</li>
</ul>
<blockquote>
<p>参考：<a href="https://docs.gradle.org/current/userguide/inspecting_dependencies.html" target="_blank" rel="external">https://docs.gradle.org/current/userguide/inspecting_dependencies.html</a></p>
</blockquote>
<p>运行gradle dependencies将为您提供所选项目的依赖关系列表，按配置细分。对于每个配置，该配置的直接和传递依赖关系都显示在树中。以下是此报告的一个示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle dependencies</div></pre></td></tr></table></figure>
<p>运行 <code>gradle buildEnvironment</code> 可视化所选项目的构建脚本依赖关系，类似于 <code>gradle dependencies</code> 可视化正在构建的软件的依赖关系。</p>
<ul>
<li>列出项目属性</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle properties</div></pre></td></tr></table></figure>
<ul>
<li>列出 model 信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle model</div></pre></td></tr></table></figure>
<p>结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line">&gt; Task :model</div><div class="line"></div><div class="line">------------------------------------------------------------</div><div class="line">Root project</div><div class="line">------------------------------------------------------------</div><div class="line"></div><div class="line">+ tasks</div><div class="line">      | Type:           org.gradle.model.ModelMap&lt;org.gradle.api.Task&gt;</div><div class="line">      | Creator:        Project.&lt;init&gt;.tasks()</div><div class="line">    + buildEnvironment</div><div class="line">          | Type:       org.gradle.api.tasks.diagnostics.BuildEnvironmentReportTask</div><div class="line">          | Value:      task &apos;:buildEnvironment&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(buildEnvironment)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + clean</div><div class="line">          | Type:       org.gradle.api.tasks.Delete</div><div class="line">          | Value:      task &apos;:clean&apos;</div><div class="line">          | Creator:    Project.&lt;init&gt;.tasks.clean()</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + components</div><div class="line">          | Type:       org.gradle.api.reporting.components.ComponentReport</div><div class="line">          | Value:      task &apos;:components&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(components)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + dependencies</div><div class="line">          | Type:       org.gradle.api.tasks.diagnostics.DependencyReportTask</div><div class="line">          | Value:      task &apos;:dependencies&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(dependencies)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + dependencyInsight</div><div class="line">          | Type:       org.gradle.api.tasks.diagnostics.DependencyInsightReportTask</div><div class="line">          | Value:      task &apos;:dependencyInsight&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(dependencyInsight)</div><div class="line">          | Rules:</div><div class="line">             ⤷ HelpTasksPlugin.Rules#addDefaultDependenciesReportConfiguration(DependencyInsightReportTask, ServiceRegistry)</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + dependentComponents</div><div class="line">          | Type:       org.gradle.api.reporting.dependents.DependentComponentsReport</div><div class="line">          | Value:      task &apos;:dependentComponents&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(dependentComponents)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + help</div><div class="line">          | Type:       org.gradle.configuration.Help</div><div class="line">          | Value:      task &apos;:help&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(help)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + init</div><div class="line">          | Type:       org.gradle.buildinit.tasks.InitBuild</div><div class="line">          | Value:      task &apos;:init&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(init)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + model</div><div class="line">          | Type:       org.gradle.api.reporting.model.ModelReport</div><div class="line">          | Value:      task &apos;:model&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(model)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + projects</div><div class="line">          | Type:       org.gradle.api.tasks.diagnostics.ProjectReportTask</div><div class="line">          | Value:      task &apos;:projects&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(projects)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + properties</div><div class="line">          | Type:       org.gradle.api.tasks.diagnostics.PropertyReportTask</div><div class="line">          | Value:      task &apos;:properties&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(properties)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + tasks</div><div class="line">          | Type:       org.gradle.api.tasks.diagnostics.TaskReportTask</div><div class="line">          | Value:      task &apos;:tasks&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(tasks)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div><div class="line">    + wrapper</div><div class="line">          | Type:       org.gradle.api.tasks.wrapper.Wrapper</div><div class="line">          | Value:      task &apos;:wrapper&apos;</div><div class="line">          | Creator:    tasks.addPlaceholderAction(wrapper)</div><div class="line">          | Rules:</div><div class="line">             ⤷ copyToTaskContainer</div></pre></td></tr></table></figure>
<p>model信息 - 模型元素的细节</p>
<table>
<thead>
<tr>
<th>详情</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>类型-Type</td>
<td>这是模型元素的基础类型，通常是完全限定的类名。</td>
</tr>
<tr>
<td>值-Value</td>
<td>当模型元素可以表示为字符串时，在报告中有条件地显示。</td>
</tr>
<tr>
<td>创造者-Creator</td>
<td>每个模型元素都有一个创建者。创建者表示模型元素的起源（即创建模型元素的原因）</td>
</tr>
<tr>
<td>规则-Rules</td>
<td>是规则的列表，不包括为给定模型元素执行的创建者规则。规则的显示顺序反映了它们的执行顺序</td>
</tr>
</tbody>
</table>
<h1 id="2-Gradle-与-Android-Studio-结合"><a href="#2-Gradle-与-Android-Studio-结合" class="headerlink" title="2. Gradle 与 Android Studio 结合"></a>2. Gradle 与 Android Studio 结合</h1><p>Android应用程序使用 <strong>Gradle</strong> 作为构建工具，通常通过唯一受支持的IDE：<strong>Android Studio</strong>。本小节来描述创建新的Android应用程序时生成的<strong>Gradle构建文件的细节</strong>，以及<strong>如何使用Gradle为其调用相关的构建任务</strong>。 </p>
<h2 id="2-1-Android-应用程序模块-的默认项目结构"><a href="#2-1-Android-应用程序模块-的默认项目结构" class="headerlink" title="2.1 Android 应用程序模块 的默认项目结构"></a>2.1 Android 应用程序模块 的默认项目结构</h2><p><img src="http://oy991qm3u.bkt.clouddn.com/project-structure_2x.png" alt=""></p>
<p><code>Android Studio</code> 将每个模块的<strong>源代码</strong>和<strong>资源逻辑</strong>分组到 <strong>源集（Source Set）</strong>中。<code>Android Studio</code> <strong>不会自动创建它们</strong>。而是 Gradle 在特定版本的 Android插件下构建它们。</p>
<p><code>src/main/</code>：该源代码集包括所有构建变体的 <strong>通用代码和资源</strong>。</p>
<h2 id="2-2-工程配置文件"><a href="#2-2-工程配置文件" class="headerlink" title="2.2 工程配置文件"></a>2.2 工程配置文件</h2><p><img src="http://oy991qm3u.bkt.clouddn.com/Project-View-Android.png" alt=""></p>
<ul>
<li><strong>(Project: HelloWorldGradle)</strong></li>
<li><p><strong>(Module: app)</strong> 附加（include ‘:app’）到 顶层构建文件。</p>
</li>
<li><p><strong>gradle.properties</strong>。</p>
<ul>
<li>一个是本地项目。</li>
<li>一个只有gradle.properties在.gradle主目录的子目录中有全局文件的同名文件才存在。</li>
</ul>
</li>
<li><p><strong>settings.gradle</strong>由Gradle用于 <strong>配置多项目构建</strong>，应该由一行代码组成：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">include &apos;:app&apos;</div></pre></td></tr></table></figure>
<p> 这告诉Gradle该app子目录也是一个Gradle项目。</p>
<ul>
<li><strong>gradle-wrapper.properties</strong>，它配置了所谓的 <strong>Gradle Wrapper</strong>。这使您可以构建Android项目，而无需首先安装Gradle。该文件的内容应该类似于：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">distributionBase=GRADLE_USER_HOME</div><div class="line">distributionPath=wrapper/dists</div><div class="line">zipStoreBase=GRADLE_USER_HOME</div><div class="line">zipStorePath=wrapper/dists</div><div class="line">distributionUrl=https\://services.gradle.org/distributions/gradle-4.1-all.zip</div></pre></td></tr></table></figure>
<p>前四行表示当包装首次运行时，它将下载Gradle发行版并将其存储在主目录<code>.gradle/wrapper/dists</code>中的目录中。</p>
<p>最后一行显示了<code>distributionUrl</code> Gradle将下载指定分布的位置的值。</p>
<ul>
<li><strong>local.properties</strong></li>
</ul>
<p>配置构建系统的本地环境属性，例如SDK安装路径。由于此文件的内容是由Android Studio自动生成的，并且特定于本地开发人员环境，因此您不应该手动修改此文件或将其检入您的版本控制系统。</p>
<h3 id="2-2-1-Project-中的-build-gradle文件"><a href="#2-2-1-Project-中的-build-gradle文件" class="headerlink" title="2.2.1 Project 中的 build.gradle文件"></a>2.2.1 Project 中的 build.gradle文件</h3><blockquote>
<p><strong>DSL元素</strong> <a href="http://google.github.io/android-gradle-dsl/current/" target="_blank" rel="external">http://google.github.io/android-gradle-dsl/current/</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line">// Top-level build file where you can add configuration options common to all sub-projects/modules.</div><div class="line"></div><div class="line">/ ** </div><div class="line"> * buildscript块是为Gradle本身配置存储库和依赖项的地方，也就是说，不应该在这里为模块包含依赖项。</div><div class="line"> * 例如，此块包含用于</div><div class="line"> * Gradle 的Android插件作为依赖项，因为它提供了Gradle 生成Android应用程序模块所需的附加指令。</div><div class="line"> * / </div><div class="line">buildscript &#123;  </div><div class="line">	/ **      </div><div class="line">	* repositories块配置Gradle用来 搜索或下载依赖项的存储库。</div><div class="line">	* Gradle预先配置对远程存储库的支持，如JCenter，Maven Central和Ivy。你也可以使用本地存储库或定义您自己的远程存储库。</div><div class="line">	* 下面的代码将JCenter 、google定义为Gradle应该用来查找其依赖项的存储库。</div><div class="line">    *使用Android Studio 3.0及更高版本</div><div class="line">创建的新项目还包括 Google的Maven存储库。</div><div class="line">    * /                </div><div class="line">    repositories &#123;</div><div class="line">        google()</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">	/ **      </div><div class="line">	*依赖关系块配置Gradle需要使用来构建项目的依赖项。以下行将Gradle 版本3.0.1的Android插件添加为类路径依赖项。    </div><div class="line">	 * /</div><div class="line">    dependencies &#123;    </div><div class="line">        /**坐标语法：‘group：name：version’ 指定所需的插件，并告诉Gradle在哪里找到它，各个 `:` 间的字段说明为：</div><div class="line">		 组 `com.android.tools.build`</div><div class="line">		 名称 `gradle`名</div><div class="line">		 版本  `3.0.1`。  </div><div class="line">	    */    </div><div class="line">	      </div><div class="line">        classpath &apos;com.android.tools.build:gradle:3.0.1&apos;</div><div class="line"></div><div class="line">        // NOTE: Do not place your application dependencies here; they belong</div><div class="line">        // in the individual module build.gradle files</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/ ** </div><div class="line">* allprojects块是您配置 项目中所有模块使用的存储库和依赖项的位置，例如第三方插件或lib。</div><div class="line">* 但是，您应该在 每个模块级别的build.gradle文件中配置模块特定的依赖项。</div><div class="line">* 对于新项目， 默认情况下，Android Studio 包含JCenter和Google的Maven存储库，但不会 配置任何依赖关系。</div><div class="line"></div><div class="line">* 对于包含多个模块的Android项目，在项目级别定义某些属性并在所有模块间共享它们可能会很有用。您可以通过向顶层文件中的块添加额外的属性来完成此操作。</div><div class="line">* 额外属性：https://docs.gradle.org/current/userguide/writing_build_scripts.html#sec:extra_properties</div><div class="line">* /</div><div class="line">allprojects &#123;                 </div><div class="line">    repositories &#123;</div><div class="line">        google()</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 特设任务</div><div class="line">task clean(type: Delete) &#123;    </div><div class="line">    delete rootProject.buildDir</div><div class="line">&#125;</div><div class="line"></div><div class="line">/**</div><div class="line">* 自定义任务</div><div class="line">* 注意：虽然Gradle允许您在模块级别定义项目范围的属性，但应该避免这样做，因为它会导致共享这些属性的模块被耦合。模块耦合使以后将模块作为独立项目导出变得更加困难</div><div class="line">*/</div><div class="line"></div><div class="line">ext &#123;</div><div class="line">    compileSdkVersion = 26</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在 <strong>build.gradle(app)</strong> 文件中调用 <strong><code>ext</code></strong> 时：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">  // Use the following syntax to access properties you defined at the project level:</div><div class="line">  // rootProject.ext.property_name</div><div class="line">  compileSdkVersion rootProject.ext.compileSdkVersion</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-2-2-Module-中的-build-gradle-文件"><a href="#2-2-2-Module-中的-build-gradle-文件" class="headerlink" title="2.2.2  Module 中的 build.gradle 文件"></a>2.2.2  Module 中的 build.gradle 文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line">/ ** </div><div class="line"> * 构建配置中的第一行将Gradle 的Android插件应用于此构建，并使android块可用于指定Android特定的构建选项。</div><div class="line"> * /</div><div class="line">apply plugin: &apos;com.android.application&apos;</div><div class="line"></div><div class="line">/ **  </div><div class="line">* android块是您配置所有Android特定构建选项的地方。 </div><div class="line">* /</div><div class="line">android &#123;</div><div class="line">    compileSdkVersion 27</div><div class="line">    / **    </div><div class="line">    * defaultConfig块封装所有构建变体的默认设置和条目</div><div class="line">    * 并且可以从构建系统动态地覆盖main/AndroidManifest.xml 中的一些属性</div><div class="line">    * / </div><div class="line">    defaultConfig &#123;</div><div class="line">    	/ **      </div><div class="line">    	* 每个Android应用程序都有一个唯一的应用程序ID，applicationId </div><div class="line">    	* 此ID在设备和Google Play商店中唯一标识您的应用，你永远不应该改变应用程序ID。  </div><div class="line">    	* 应用程序ID 和 软件包名 彼此独立  </div><div class="line">    	* 但是，您的源代码仍应引用 main/ AndroidManifest.xml文件中的包属性定义的包名。</div><div class="line">	    */</div><div class="line">        applicationId &quot;com.esint.hellogradle&quot;</div><div class="line">        //定义运行应用程序所需的最低API级别。</div><div class="line">        minSdkVersion 19</div><div class="line">        //指定用于测试应用程序的API级别。</div><div class="line">        targetSdkVersion 27</div><div class="line">        //定义您的应用程序的版本号。</div><div class="line">        versionCode 1</div><div class="line">        //为应用定义一个用户友好的版本名称。</div><div class="line">        versionName &quot;1.0&quot;</div><div class="line">        testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    / **    </div><div class="line">    * buildTypes块是您可以配置多个构建类型的位置。</div><div class="line">    * 默认情况下，构建系统定义两种构建类型：调试和发布。</div><div class="line">    * 调试版本类型没有在默认已经明确显示，但它包含调试工具，并用调试密钥签名。</div><div class="line">    * 构建类型应用Proguard设置，并且默认情况下未进行签名。   </div><div class="line">    */</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            //为发布构建类型启用代码缩小。</div><div class="line">            minifyEnabled false</div><div class="line">            proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        / **    </div><div class="line">        * productFlavors块是您可以配置多个产品风格的地方。这允许您创建不同版本的应用程序，可以用自己的设置覆盖defaultConfig块。</div><div class="line">        * 产品风格是可选的，构建系统默认不会创建它们。这个例子：</div><div class="line">        * 创建一个免费和付费的产品风格。然后指定每种产品风格自己的应用程序ID，以便它们可以同时存在于Google Play商店或Android设备上。</div><div class="line">        * 如果您使用Android插件3.0.0或更高版本，则还需要声明并将每种风味分配到风味维度。</div><div class="line">        */</div><div class="line">        productFlavors &#123;</div><div class="line">		    free &#123;</div><div class="line">		      applicationId &apos;com.example.myapp.free&apos;</div><div class="line">		    &#125;</div><div class="line">		</div><div class="line">		    paid &#123;</div><div class="line">		      applicationId &apos;com.example.myapp.paid&apos;</div><div class="line">		    &#125;</div><div class="line">	     &#125;</div><div class="line">      / **    </div><div class="line">      * 分割块是您可以配置不同的APK构建的地方</div><div class="line">      * 每个仅包含支持屏幕密度或ABI的代码和资源。您还需要配置您的版本，以便每个APK具有不同的版本代码。</div><div class="line">      */ </div><div class="line">		splits &#123;</div><div class="line">		    //设置根据屏幕密度构建多个APK。</div><div class="line">		    density &#123;</div><div class="line">		</div><div class="line">		      //启用或禁用构建多个APK。</div><div class="line">		      enable false</div><div class="line">		</div><div class="line">		      //构建多个APK时排除这些密度。</div><div class="line">		      exclude &quot;ldpi&quot;, &quot;tvdpi&quot;, &quot;xxxhdpi&quot;, &quot;400dpi&quot;, &quot;560dpi&quot;</div><div class="line">		    &#125;</div><div class="line">		  &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">dependencies &#123;</div><div class="line">    implementation fileTree(dir: &apos;libs&apos;, include: [&apos;*.jar&apos;])</div><div class="line">    implementation &apos;com.android.support:appcompat-v7:27.1.1&apos;</div><div class="line">    implementation &apos;com.android.support.constraint:constraint-layout:1.1.0&apos;</div><div class="line">    testImplementation &apos;junit:junit:4.12&apos;</div><div class="line">    androidTestImplementation &apos;com.android.support.test:runner:1.0.2&apos;</div><div class="line">    androidTestImplementation &apos;com.android.support.test.espresso:espresso-core:3.0.2&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>配置文件块 - dependencies</strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    implementation fileTree(dir: &apos;libs&apos;, include: [&apos;*.jar&apos;])</div><div class="line">    implementation &apos;com.android.support:appcompat-v7:27.1.1&apos;</div><div class="line">    implementation &apos;com.android.support.constraint:constraint-layout:1.1.0&apos;</div><div class="line">    testImplementation &apos;junit:junit:4.12&apos;</div><div class="line">    androidTestImplementation &apos;com.android.support.test:runner:1.0.2&apos;</div><div class="line">    androidTestImplementation &apos;com.android.support.test.espresso:espresso-core:3.0.2&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>配置</strong> <code>依赖关系</code>是构建Gradle应用程序的基础部分。在这种情况下，<code>dependencies</code>部分显示的值<code>implementation</code>，<code>testImplementation</code>和<code>androidTestImplementation</code>配置。</p>
<ul>
<li>最简单的一个，<strong><code>testImplementation</code></strong>依赖关系只包含最新的稳定JUnit 4发行版。JUnit类和测试注释将在编译时在<code>src/test/java</code>层次结构中可用。</li>
<li><p>有三条线添加了对<strong><code>implementation</code></strong> 配置的依赖关系：</p>
<ul>
<li><p>第一，<code>fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;])</code>是一个 <strong>fileTree依赖项</strong>，它将文件libs夹中的所有jar文件添加到编译类路径中</p>
</li>
<li><p>第二，<code>com.android.support:appcompat-v7:26.1.0</code>将 <strong>Android兼容性库</strong> 添加到项目中。这使您可以在SDK版本7以前的任何Android应用程序中使用Material设计主题和其他功能。</p>
</li>
<li><p>第三，<code>com.android.support.constraint:constraint-layout:1.0.2</code>将Android约束布局添加到项目中。这使您可以在SDK版本9以前的任何Android应用程序中使用ConstraintLayout布局类。</p>
</li>
</ul>
</li>
<li><p><code>androidTestImplementation</code>依赖关系是指Espresso测试库，用于Android应用程序的集成测试。</p>
</li>
</ul>
<h2 id="2-3-在终端中运行-Android-的-Gradle-命令"><a href="#2-3-在终端中运行-Android-的-Gradle-命令" class="headerlink" title="2.3 在终端中运行 Android 的 Gradle 命令"></a>2.3 在终端中运行 Android 的 Gradle 命令</h2><p>在通过 Android Studio 构建和部署应用程序时，可以通过在 <code>终端中</code> 进入项目的根目录，在该目录下，运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./gradlew build</div></pre></td></tr></table></figure>
<p>这将运行许多任务，并最终返回“构建成功”。要查看生成的APK（Android包，Android应用的可部署版本），可看目录<code>app/build/outputs/apk</code>。在那里你会找到一个debug和一个release目录。该debug目录包含app-debug.apk将被部署到模拟器或连接设备的APK版本。如果您想部署发行版APK，则需要首先创建签名配置.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">./gradlew：app：dependencies --configuration releaseCompileClasspath </div><div class="line"></div><div class="line">./gradlew：app：dependencyInsight --dependency support-annotations --configuration releaseCompileClasspath</div></pre></td></tr></table></figure>
<p><strong>注意：任何Gradle项目中都有 dependency 和 dependencyInsight 任务可用。它们可以帮助 追踪并解决与库版本冲突有关 的任何问题。</strong></p>
<h2 id="2-4-使用-Android-Studio-中的-Gradle窗口"><a href="#2-4-使用-Android-Studio-中的-Gradle窗口" class="headerlink" title="2.4 使用 Android Studio 中的 Gradle窗口"></a>2.4 使用 Android Studio 中的 Gradle窗口</h2><p>Android Studio包含一个执行Gradle任务的特殊窗口。Android项目提供超过80种不同的任务，并且此窗口尝试将它们组织到不同的类别中。</p>
<p><img src="http://oy991qm3u.bkt.clouddn.com/Gradle-window-signingReport.png" alt=""></p>
<p>可以通过此窗口，手动点击要执行的任务，查看在执行一种操作时，背后执行的具体tasks。</p>
<h1 id="3-Gradle-与-APK-的构建"><a href="#3-Gradle-与-APK-的构建" class="headerlink" title="3. Gradle 与 APK 的构建"></a>3. Gradle 与 APK 的构建</h1><blockquote>
<p>参考：<a href="https://developer.android.com/studio/build/gradle-tips" target="_blank" rel="external">https://developer.android.com/studio/build/gradle-tips</a></p>
</blockquote>
<ul>
<li><p><strong>Gradle 运行过程</strong></p>
<ul>
<li>Initializatin</li>
<li>Configuration</li>
<li>Execution</li>
</ul>
</li>
<li><p><strong>在构建App时，Gradle配置文件的执行过程：</strong></p>
<p><strong><code>settings.gradle</code></strong>  -&gt; <strong><code>(Project)build.gradle</code></strong> -&gt; <strong><code>(Module)build.gradle</code></strong>  （可以使用 println()进行验证）<br>即： <strong>顺序执行</strong> — <strong>先运行 settings配置文件，再运行 Project，再运行 Module</strong>。</p>
</li>
</ul>
<h2 id="3-1-applicationId"><a href="#3-1-applicationId" class="headerlink" title="3.1 applicationId"></a>3.1 applicationId</h2><h3 id="3-1-1-applicationId-与-Java包名称"><a href="#3-1-1-applicationId-与-Java包名称" class="headerlink" title="3.1.1 applicationId 与 Java包名称"></a>3.1.1 applicationId 与 Java包名称</h3><p> 每个Android应用程序都有一个唯一的应用程序ID，看起来像一个Java包名称，<strong>此ID在设备和Google Play商店中唯一标识您的应用</strong>。如果想上传应用程序的<strong>新版本</strong>，则应用程序ID（以及您对其签名的证书）<strong>必须</strong>与<strong>原始APK相同</strong>，如果更改应用程序ID，则Google Play Store会将APK视为完全不同的应用程序应用程序。所以一旦你发布你的应用程序，你永远不应该改变应用程序ID。</p>
<pre><code>当在 Android Studio中 创建新项目时，applicationId 与在安装过程中选择的 Java风格包名称完全匹配。
但是，除此之外， 应用程序ID 和 软件包名称 彼此独立。
可以更改代码的包名称（代码名称空间），它不会影响应用程序ID，反之亦然（但是，一旦发布应用程序，不应再更改您的应用程序ID）。
</code></pre><p> <strong>命名规则：</strong></p>
<ul>
<li>它必须至少有两个部分（一个或多个点）。</li>
<li>每个部分必须以字母开头。</li>
<li>所有字符必须是字母数字或下划线[a-zA-Z0-9_]。</li>
</ul>
<p><strong>注意：</strong><br> applicationId用于 <strong>直接绑定到代码的包名称</strong> ; 所以一些Android API在其方法名称和参数名称中使用术语 <strong>包名称</strong> ，但这实际上是 <strong>applicationId</strong>。</p>
<h3 id="3-1-2-更改-包名称"><a href="#3-1-2-更改-包名称" class="headerlink" title="3.1.2 更改 包名称"></a>3.1.2 更改 包名称</h3><p>尽管默认情况下 <strong>项目的包名称</strong> 与 <strong>应用程序ID</strong> 相匹配，但可以更改它。如果要更改软件包名称，请注意<strong><code>软件包名称</code>（由项目目录结构定义）应始终与 <code>AndroidManifest.xml</code> 文件中的 <code>package</code> 属性匹配</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    package=&quot;com.example.myapp&quot;</div><div class="line">    android:versionCode=&quot;1&quot;</div><div class="line">    android:versionName=&quot;1.0&quot; &gt;</div></pre></td></tr></table></figure>
<p>gradle 使用这个 <strong>package属性</strong> 来做两件事情：</p>
<ul>
<li><p>将此名称用作应用程序生成的 <strong>R.java类的名称空间</strong> 。</p>
<p>例子：通过上面的清单，R该类将会是 <code>com.example.myapp.R</code>。</p>
</li>
<li><p>使用它来 <strong>解析</strong> 清单文件中声明的 <strong>任何相关类名称</strong>。</p>
<p>示例：通过上面的清单，声明为 <code>&lt;activity android:name=&quot;.MainActivity&quot;&gt;</code> 已解析为 的活动为 <code>com.example.myapp.MainActivity</code>。</p>
</li>
</ul>
<h3 id="3-2-3-一个参考示例：-更改applicationId-“免费”和“专业版”"><a href="#3-2-3-一个参考示例：-更改applicationId-“免费”和“专业版”" class="headerlink" title="3.2.3 一个参考示例： 更改applicationId - “免费”和“专业版”"></a>3.2.3 一个参考示例： 更改applicationId - “免费”和“专业版”</h3><p>如果想创建不同版本的应用在Google Play商店中显示为<strong>单独列表</strong>，例如“<strong>免费</strong>”和“<strong>专业版</strong>”，则需要创建单独的构建变体，每个变体都具有不同的应用程序标识。</p>
<p>在这种情况下，应该将<strong>每个构建变体</strong>定义为<strong>独立的产品风格</strong>。对于 productFlavors块内的每种风格，您可以<strong>重新定义该 applicationId 属性</strong>，或者可以使用以下代码段将缺省应用程序ID附加到一个段中applicationIdSuffix，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    defaultConfig &#123;</div><div class="line">        applicationId &quot;com.example.myapp&quot;</div><div class="line">    &#125;</div><div class="line">    productFlavors &#123;</div><div class="line">        free &#123;</div><div class="line">            applicationIdSuffix &quot;.free&quot;</div><div class="line">        &#125;</div><div class="line">        pro &#123;</div><div class="line">            applicationIdSuffix &quot;.pro&quot;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样，“免费”产品风格的应用程序ID是<code>com.example.myapp.free</code>。</p>
<p>您也可以使用<code>applicationIdSuffix</code>基于您的<strong>构建类型</strong>添加细分，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    ...</div><div class="line">    buildTypes &#123;</div><div class="line">        debug &#123;</div><div class="line">            applicationIdSuffix &quot;.debug&quot;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>因为Gradle在 <strong>产品风格</strong> 之后应用了 <strong>构建类型配置（debug、release）</strong>，所以 <strong>免费-调试版apk</strong> 构建变体的 <code>applicationId</code> 现在是： <strong>com.example.myapp.free.debug</strong>。</p>
<p>当希望将 <strong>免费-调试版本apk</strong> 和 <strong>免费-发布版本apk</strong> 构建在 <strong>同一设备上</strong>时，这非常有用，因为没有两个APK可以具有相同的应用程序ID。</p>
<h2 id="3-2-构建流程。"><a href="#3-2-构建流程。" class="headerlink" title="3.2 构建流程。"></a>3.2 构建流程。</h2><p>典型 APK 的构建流程</p>
<p><img src="http://oy991qm3u.bkt.clouddn.com/build-process_2x.png" alt=""></p>
<p><strong>注意</strong></p>
<ul>
<li>编译器 <strong>源代码</strong> 转换成 <strong>DEX（Dalvik Executable) 文件</strong>（其中包括运行在 Android 设备上的字节码），将所有<strong>其他内容</strong>转换成<strong>已编译资源</strong>。</li>
<li>APK 打包器将 DEX 文件和已编译资源 <strong>合并</strong> 成单个 <strong>APK</strong>。不过，<strong>必须先签署 APK</strong>，才能将应用<strong>安装并部署</strong>到 Android 设备上。</li>
<li>APK 打包器使用<strong>调试或发布密钥库签署</strong> APK：<ul>
<li>如果您构建的是<strong>调试版本的应用</strong>（即专用于测试和分析的应用），打包器会<strong>使用调试密钥库</strong>签署您的应用。Android Studio 自动使用调试密钥库配置新项目。</li>
<li>如果您构建的是打算向外<strong>发布的发布版本应用</strong>，打包器会使用<strong>发布密钥库签署</strong>应用。要创建发布密钥库。</li>
</ul>
</li>
<li>在生成最终 APK 之前，打包器会<strong>使用 zipalign 工具对应用进行优化，减少其在设备上运行时的内存占用</strong>。</li>
<li><strong>task执行过程</strong>：既可以执行 <strong>单个task</strong>，又可以将  <strong>多个tasks串联执行</strong> </li>
</ul>
<p>参照对应：<strong>apk的打包流程图</strong></p>
<p><img src="http://oy991qm3u.bkt.clouddn.com/3606778-b978b976f8d0f591.png" alt=""></p>
<p>在对 APK 执行具体的构建时，Gradle 运行的顺序为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">settings.gradle -&gt; (Project)build.gradle -&gt; (Module)build.gradle -&gt; 所需的 Tasks</div></pre></td></tr></table></figure>
<p>如图，执行 <strong>assembleDebu</strong> task 的过程：</p>
<p><img src="http://oy991qm3u.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-07-14%2011.14.24.png" alt=""></p>
<h2 id="3-3-配置文件中几种常见的配置"><a href="#3-3-配置文件中几种常见的配置" class="headerlink" title="3.3 配置文件中几种常见的配置"></a>3.3 配置文件中几种常见的配置</h2><ul>
<li><p><strong>Build Types</strong></p>
<p>构建类型定义了Gradle在<strong>构建</strong>和<strong>打包应用程</strong>序时使用的<strong>特定属性</strong>，并且通常针对开发生命周期的<strong>不同阶段</strong>进行配置。例如，</p>
<ul>
<li>调试构建类型启用调试选项并使用调试密钥对APK进行签名，</li>
<li>发布构建类型可能会缩小、混淆并用发布密钥对APK进行签名进行分发。</li>
</ul>
<p>必须至少定义一种构建类型，才能构建应用程序。Android Studio默认创建 <strong>调试</strong> 和 <strong>发布</strong> 构建类型。</p>
</li>
<li><p><strong>Product Flavors</strong></p>
<p><code>产品风格</code> 代表您可能发布给用户的不同版本的应用，例如免费和付费版本的应用。您可以自定义产品风格以使用不同的代码和资源，同时共享和重复使用适用于所有版本应用程序的通用部件。产品风格是可选的，须手动创建它们</p>
</li>
</ul>
<ul>
<li><strong>Manifest Entries</strong></li>
</ul>
<p>您可以在构建变体配置中为清单文件的某些属性指定值。这些构建值会 <strong>覆盖清单文件中的现有值</strong>。如果您希望为您的模块生成多个APK，其中每个apk文件都具有不同的应用程序名称，最低SDK版本或目标SDK版本</p>
<ul>
<li><strong>Dependencies</strong></li>
</ul>
<p>构建系统从 <strong>本地文件系统</strong> 和 <strong>远程存储库管理项目</strong> 依赖关系。这样可以防止您必须手动搜索，下载和复制依赖关系的二进制包到项目目录中</p>
<ul>
<li><strong>Signing</strong></li>
</ul>
<p>构建系统使您能够在构建配置中指定签名设置，并且可以在构建过程中自动签署APK。</p>
<ul>
<li><strong>ProGuard</strong></li>
</ul>
<p>构建系统使您能够为每个构建变体指定不同的ProGuard规则文件。构建系统可以在构建过程中运行ProGuard来混淆你的类。</p>
<h2 id="3-4-依赖项：dependencies问题"><a href="#3-4-依赖项：dependencies问题" class="headerlink" title="3.4 依赖项：dependencies问题"></a>3.4 依赖项：dependencies问题</h2><blockquote>
<p><a href="https://developer.android.com/studio/build/dependencies" target="_blank" rel="external">https://developer.android.com/studio/build/dependencies</a><br>DSL参考：<a href="http://google.github.io/android-gradle-dsl/current/" target="_blank" rel="external">http://google.github.io/android-gradle-dsl/current/</a></p>
</blockquote>
<h3 id="3-4-1-依赖的3种类型"><a href="#3-4-1-依赖的3种类型" class="headerlink" title="3.4.1 依赖的3种类型"></a>3.4.1 依赖的3种类型</h3><ul>
<li><strong>本地库模块依赖关系</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile project(&quot;:mylibrary&quot;)</div></pre></td></tr></table></figure>
<ul>
<li><strong>本地依赖</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile fileTree(dir: &apos;libs&apos;, include: [&apos;*.jar&apos;])</div></pre></td></tr></table></figure>
<ul>
<li><strong>远程依赖</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile &apos;com.example.android:app-magic:12.3&apos;</div></pre></td></tr></table></figure>
<h3 id="3-4-2-库依赖配置"><a href="#3-4-2-库依赖配置" class="headerlink" title="3.4.2 库依赖配置"></a>3.4.2 库依赖配置</h3><p>在dependencies块内部，可以使用几种不同的依赖配置之一来声明库依赖关系（如上compile所示）。每个依赖配置都提供了有关<strong>如何使用该库的Gradle不同指导</strong>。</p>
<ul>
<li><strong>compile</strong></li>
</ul>
<p>Gradle将该依赖项<strong>添加</strong>到<strong>编译类路径</strong>和<strong>APK中</strong>。</p>
<ul>
<li><strong>apk</strong></li>
</ul>
<p>Gradle只将相关性添加到APK（它不会被添加到编译类路径中）。</p>
<ul>
<li><strong>provided</strong></li>
</ul>
<p>Gradle<strong>仅将编译类路径</strong>添加到编译类路径中（<strong>它不会添加到APK中</strong>）。这在创建Android库模块时非常有用， 并且在编译期间需要依赖关系，但在运行时存在此选项是可选的。也就是说，如果你使用这个配置，那么你的库模块必须包含一个运行时条件来检查依赖关系是否可用，然后适当地改变它的行为，以便它在没有提供时仍然可以运行。这有助于减少最终APK的大小，因为不会添加不重要的临时依赖项。</p>
<p><strong>注意：</strong><br>以上配置适用于项目的<strong>主源集</strong>，该集<strong>适用于所有构建变体</strong>。如果您不想为特定的构建变体源集或 测试源集声明一个依赖项 ，则必须<strong>大写配置名称</strong>，并在其前面加上构建变体或测试源集的名称。</p>
<p>1)  要<strong>将compile依赖项仅添加到“免费”产品特征</strong>（使用远程二进制依赖项），它看起来像这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    freeCompile &apos;com.google.firebase:firebase-ads:9.8.0&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2) 如果要<strong>为组合产品风格</strong>和<strong>构建类型的变体</strong>添加依赖项，则必须在<strong>configurations块</strong>中初始化配置名称。以下示例将apk依赖项添加到“freeDebug”构建变体（使用本地二进制依赖项）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">configurations &#123;</div><div class="line">    // Initializes a placeholder for the freeDebugApk dependency configuration.</div><div class="line">    freeDebugApk &#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">dependencies &#123;</div><div class="line">    freeDebugApk fileTree(dir: &apos;libs&apos;, include: [&apos;*.jar&apos;])</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3) 要compile为您的<strong>本地测试</strong>和<strong>仪器测试</strong>添加依赖项，它看起来像这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    // Adds a remote binary dependency only for local tests.</div><div class="line">    testCompile &apos;junit:junit:4.12&apos;</div><div class="line"></div><div class="line">    // Adds a remote binary dependency only for the instrumented test APK.</div><div class="line">    androidTestCompile &apos;com.android.support.test.espresso:espresso-core:3.0.2&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>4) 如果你的<strong>lib模块</strong>提供了多种变体，你可以为不同的应用变体添加不同的lib变体，如下所示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">  // Adds the &apos;debug&apos; variant of the library to the debug variant of the app</div><div class="line">  debugCompile project(path: &apos;:my-library-module&apos;, configuration: &apos;debug&apos;)</div><div class="line"></div><div class="line">  // Adds the &apos;release&apos; variant of the library to the release variant of the app</div><div class="line">  releaseCompile project(path: &apos;:my-library-module&apos;, configuration: &apos;release&apos;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="3-4-3-远程存储库"><a href="#3-4-3-远程存储库" class="headerlink" title="3.4.3 远程存储库"></a>3.4.3 远程存储库</h3><p>当依赖项<strong>不是本地库</strong>或<strong>文件树</strong>时，Gradle会在文件<code>repositories块</code>中指定的任何联机存储库中查找这些 build.gradle文件。</p>
<p>默认情况下，新的<code>Android Studio</code>项目将<code>JCenter</code>声明为项目顶层build.gradle文件中的存储库位置，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">allprojects &#123;</div><div class="line">    repositories &#123;</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果想从Maven中央存储库中获取某些内容，请添加 mavenCentral()或为本地存储库使用mavenLocal()：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">allprojects &#123;</div><div class="line">    repositories &#123;</div><div class="line">        jcenter()</div><div class="line">        mavenCentral()</div><div class="line">        mavenLocal()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>或者，可以按如下方式声明特定的Maven或Ivy存储库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">allprojects &#123;</div><div class="line">    repositories &#123;</div><div class="line">        maven &#123;</div><div class="line">            url &quot;https://repo.example.com/maven2&quot;</div><div class="line">        &#125;</div><div class="line">        maven &#123;</div><div class="line">            url &quot;file://local/repo/&quot;</div><div class="line">        &#125;</div><div class="line">        ivy &#123;</div><div class="line">            url &quot;https://repo.example.com/ivy&quot;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="3-4-4-Google的Maven存储库"><a href="#3-4-4-Google的Maven存储库" class="headerlink" title="3.4.4 Google的Maven存储库"></a>3.4.4 Google的Maven存储库</h3><p>Google的Maven存储库提供了以下Android库的最新版本</p>
<ul>
<li>Android Support Library</li>
<li>Architecture Components Library</li>
<li>Constraint Layout Library</li>
<li>Android Test</li>
<li>Databinding Library</li>
<li>Android Instant App Library</li>
<li>Wear OS</li>
<li>Google Play services</li>
<li>Firebase</li>
</ul>
<p>要将这些库中的一个添加到您的版本中，请在您的顶级build.gradle文件中包含Google的Maven存储库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">allprojects &#123;</div><div class="line">    repositories &#123;</div><div class="line">        google()</div><div class="line"></div><div class="line">        // If you&apos;re using a version of Gradle lower than 4.1, you must instead use:</div><div class="line">        // maven &#123;</div><div class="line">        //     url &apos;https://maven.google.com&apos;</div><div class="line">        // &#125;</div><div class="line">        // An alternative URL is &apos;https://dl.google.com/dl/android/maven2/&apos;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后将所需的库添加到您的模块的<code>dependencies块</code>。例如， <code>appcompat库</code> 看起来像这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    compile &apos;com.android.support:appcompat-v7:27.1.1&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="3-4-5-依赖顺序"><a href="#3-4-5-依赖顺序" class="headerlink" title="3.4.5 依赖顺序"></a>3.4.5 依赖顺序</h3><p>第一个库的优先级高于第二个，第二个的优先级高于第三个，依此类推。在<code>资源合并</code>或 <code>清单元素</code>从库中合并到您的应用中时，此顺序非常重要 。</p>
<p>例如，如果您的项目声明以下内容:</p>
<pre><code>Dependency on LIB_A and LIB_B (依次)
And LIB_A depends on LIB_C and LIB_D (依次)
And LIB_B also depends on LIB_C
</code></pre><p>然后，平面相关性顺序如下：</p>
<pre><code>LIB_A
LIB_D
LIB_B
LIB_C
</code></pre><h3 id="3-4-6-收缩代码"><a href="#3-4-6-收缩代码" class="headerlink" title="3.4.6 收缩代码"></a>3.4.6 收缩代码</h3><p>要使用<code>ProGuard</code>缩小代码，<code>minifyEnabled true</code></p>
<p>请注意缩短代码会减慢构建时间，所以如果可能的话，应该避免在调试版本上使用它。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled true</div><div class="line">            proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>注意：</strong>使用<code>Instant Run</code>时，Android Studio会禁用<code>ProGuard</code>。</p>

      
    </div>
    
    
    

    

    


    <footer class="post-footer">
      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/温故知新-数据结构-3/" rel="next" title="温故知新-数据结构-3">
                <i class="fa fa-chevron-left"></i> 温故知新-数据结构-3
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Android-aar/" rel="prev" title="Android-aar">
                Android-aar <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="http://oy991qm3u.bkt.clouddn.com/%E6%A2%B5%E9%AB%98.gif"
                alt="YannisCheng" />
            
              <p class="site-author-name" itemprop="name">YannisCheng</p>
              <p class="site-description motion-element" itemprop="description">不必一味的讨好别人，每个人都有自己的活法。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">107</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">16</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">55</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/YannisCheng" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:cwj1714@163.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-Gradle概述"><span class="nav-number">1.</span> <span class="nav-text">1. Gradle概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-安装"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-1-先决条件"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1.1 先决条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-2-安装"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.1.2 安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-3-验证安装"><span class="nav-number">1.1.3.</span> <span class="nav-text">1.1.3 验证安装</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-创建新的Gradle项目"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 创建新的Gradle项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-1-创建一个新的目录"><span class="nav-number">1.2.1.</span> <span class="nav-text">1.2.1 创建一个新的目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-2-初始化项目"><span class="nav-number">1.2.2.</span> <span class="nav-text">1.2.2 初始化项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-3-创建一个新任务"><span class="nav-number">1.2.3.</span> <span class="nav-text">1.2.3 创建一个新任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-4-应用一个插件"><span class="nav-number">1.2.4.</span> <span class="nav-text">1.2.4 应用一个插件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-5-发现更多的可用-task"><span class="nav-number">1.2.5.</span> <span class="nav-text">1.2.5 发现更多的可用 task</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-命令"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-1-一般命令："><span class="nav-number">1.3.1.</span> <span class="nav-text">1.3.1 一般命令：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-2-执行任务"><span class="nav-number">1.3.2.</span> <span class="nav-text">1.3.2 执行任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-3-常用-Task"><span class="nav-number">1.3.3.</span> <span class="nav-text">1.3.3 常用 Task</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-4-项目信息-Task"><span class="nav-number">1.4.</span> <span class="nav-text">1.3.4 项目信息 Task</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-Gradle-与-Android-Studio-结合"><span class="nav-number">2.</span> <span class="nav-text">2. Gradle 与 Android Studio 结合</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-Android-应用程序模块-的默认项目结构"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 Android 应用程序模块 的默认项目结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-工程配置文件"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 工程配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-1-Project-中的-build-gradle文件"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.2.1 Project 中的 build.gradle文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-2-Module-中的-build-gradle-文件"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2.2  Module 中的 build.gradle 文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-在终端中运行-Android-的-Gradle-命令"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 在终端中运行 Android 的 Gradle 命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-使用-Android-Studio-中的-Gradle窗口"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 使用 Android Studio 中的 Gradle窗口</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-Gradle-与-APK-的构建"><span class="nav-number">3.</span> <span class="nav-text">3. Gradle 与 APK 的构建</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-applicationId"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 applicationId</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-1-applicationId-与-Java包名称"><span class="nav-number">3.1.1.</span> <span class="nav-text">3.1.1 applicationId 与 Java包名称</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-2-更改-包名称"><span class="nav-number">3.1.2.</span> <span class="nav-text">3.1.2 更改 包名称</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-3-一个参考示例：-更改applicationId-“免费”和“专业版”"><span class="nav-number">3.1.3.</span> <span class="nav-text">3.2.3 一个参考示例： 更改applicationId - “免费”和“专业版”</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-构建流程。"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 构建流程。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-配置文件中几种常见的配置"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 配置文件中几种常见的配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-依赖项：dependencies问题"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 依赖项：dependencies问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-1-依赖的3种类型"><span class="nav-number">3.4.1.</span> <span class="nav-text">3.4.1 依赖的3种类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-2-库依赖配置"><span class="nav-number">3.4.2.</span> <span class="nav-text">3.4.2 库依赖配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-3-远程存储库"><span class="nav-number">3.4.3.</span> <span class="nav-text">3.4.3 远程存储库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-4-Google的Maven存储库"><span class="nav-number">3.4.4.</span> <span class="nav-text">3.4.4 Google的Maven存储库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-5-依赖顺序"><span class="nav-number">3.4.5.</span> <span class="nav-text">3.4.5 依赖顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-6-收缩代码"><span class="nav-number">3.4.6.</span> <span class="nav-text">3.4.6 收缩代码</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2016 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YannisCheng</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">220.9k</span>
  
</div>













        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.3"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.3"></script>


  


<script type="text/javascript" color="18,146,19" opacity='0.7' zIndex="-1" count="0" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script>

</body>
</html>
