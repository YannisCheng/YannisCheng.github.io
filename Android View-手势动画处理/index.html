<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">






  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Android,View," />










<meta name="description" content="参考：https://developer.android.com/reference/android/view/MotionEvent.html">
<meta name="keywords" content="Android,View">
<meta property="og:type" content="article">
<meta property="og:title" content="View - 手势动画处理">
<meta property="og:url" content="http://yannischeng.com/Android View-手势动画处理/index.html">
<meta property="og:site_name" content="YannisCheng&#39;s Technology Blogs">
<meta property="og:description" content="参考：https://developer.android.com/reference/android/view/MotionEvent.html">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/View.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-07-26%2013.18.07.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-07-26%2013.18.07.png">
<meta property="og:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/623378-f45e4c2e22f0e8aa.png">
<meta property="og:updated_time" content="2018-11-20T13:04:37.148Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="View - 手势动画处理">
<meta name="twitter:description" content="参考：https://developer.android.com/reference/android/view/MotionEvent.html">
<meta name="twitter:image" content="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/View.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yannischeng.com/Android View-手势动画处理/"/>





  <title>View - 手势动画处理 | YannisCheng's Technology Blogs</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">YannisCheng's Technology Blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">不必一味的讨好别人，每个人都有自己的活法。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yannischeng.com/Android View-手势动画处理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YannisCheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://oy991qm3u.bkt.clouddn.com/%E6%A2%B5%E9%AB%98.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YannisCheng's Technology Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">View - 手势动画处理</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-08T13:56:58+08:00">
                2018-01-08
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-11-20T21:04:37+08:00">
                2018-11-20
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,137 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    

    
        <div class="post-tags">
          
            <a href="/tags/Android/" rel="tag"># Android</a>
          
            <a href="/tags/View/" rel="tag"># View</a>
          
        </div>
      

    
    
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    YannisCheng
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://yannischeng.com/Android View-手势动画处理/" title="View - 手势动画处理">http://yannischeng.com/Android View-手势动画处理/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    尊重个人劳动成果，转载请注明出处。 ─=≡Σ(((つ•̀ω•́)つ))
  </li>
</ul>

      </div>
    



    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <blockquote>
<p>参考：<a href="https://developer.android.com/reference/android/view/MotionEvent.html" target="_blank" rel="external">https://developer.android.com/reference/android/view/MotionEvent.html</a></p>
</blockquote>
<a id="more"></a>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/View.png" alt=""></p>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-07-26%2013.18.07.png" alt=""></p>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-07-26%2013.18.07.png" alt=""></p>
<h1 id="相关的类"><a href="#相关的类" class="headerlink" title="相关的类"></a>相关的类</h1><ul>
<li><strong>MotionEvent</strong>类：存储触摸事件的信息</li>
<li><strong>VelocityTracker</strong>类：速度追踪类</li>
<li><strong>Gandroid.view.GestureDetector</strong> : 手势操作的识别类，通过他来使用下面的识别接口。</li>
<li><strong>android.view.GestureDetector.SimpleOnGestureListener</strong> : 手势识别的接口类，使用他可以按需重载自己想要的方法，方法多</li>
<li><strong>android.view.GestureDetector.OnGestureListener</strong> : 手势识别的类，SimpleOnGestureListener接口的父类。使用他需要实现他所有的方法。</li>
</ul>
<h1 id="Android事件响应机制"><a href="#Android事件响应机制" class="headerlink" title="Android事件响应机制"></a>Android事件响应机制</h1><p><strong>View.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent event)</span></span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span></span></div></pre></td></tr></table></figure>
<p><strong>ViewGroup.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent event)</span></span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onInterceptTouchEvent</span><span class="params">(MotionEvent event)</span></span></div></pre></td></tr></table></figure>
<p><code>onTouchEvent</code>是真正用来进行业务逻辑处理的地方，返回true表示已经将该事件消费，返回false表明事件继续传递。</p>
<p><code>onInterceptTouchEvent</code>是用来进行判断是否需要对事件进行拦截从而阻止其继续往子组件传递的，返回false表示无需拦截，则递归的调用子组件的<code>dispatchTouchEvent</code>方法；返回true表示需要拦截，则直接调用本组件的onTouchEvent方法进行处理。</p>
<p>一般我们是在<code>View</code>的<code>onTouchEvent</code>方法中处理<code>MotionEvent</code>对象的.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span></span></div></pre></td></tr></table></figure>
<h1 id="1-概述：MotionEvent-用于报告移动事件对象"><a href="#1-概述：MotionEvent-用于报告移动事件对象" class="headerlink" title="1. 概述：MotionEvent 用于报告移动事件对象"></a>1. 概述：MotionEvent 用于报告移动事件对象</h1><ul>
<li>通过“<strong>动作代码</strong>” + “<strong>一组轴值</strong>”来描述运动。</li>
</ul>
<p><strong>动作代码</strong> ：发生的状态变化，如指针向下或向上<br><strong>一族轴值</strong> ：描述位置和其他运动属性</p>
<p>例如，当用户第一次触摸屏幕时，系统View通过动作代码ACTION_DOWN 和一组包含触摸的X和Y坐标的轴值以及关于触摸的压力，大小和方向的信息接触面积。</p>
<ul>
<li><strong>运动事件</strong> 与 <strong>指针</strong></li>
</ul>
<p>有些设备可以同时报告多个移动轨迹。多点触摸屏为每个手指发出一个<strong>运动轨迹</strong>。产生运动轨迹的<strong>各个手指</strong>或<strong>其他物体</strong>被称为<strong>指针</strong>。<strong>运动事件</strong>包含有关当前活动的<strong>所有指针</strong>的<strong>信息</strong>，即使其中一些指针自从上次事件发送以来尚未移动。除非手势被取消，否则指针的数目只会随着单个指针的上下而改变。</p>
<ul>
<li>指针 “<strong>ID</strong>” 与 “<strong>索引</strong>”</li>
</ul>
<p>每个<strong>指针</strong>都有一个<strong>唯一的标识</strong>，当它第一次出现时被分配（用ACTION_DOWNor 表示ACTION_POINTER_DOWN）。指针ID保持有效，直到指针最终上升（由ACTION_UP 或指示ACTION_POINTER_UP）或手势被取消（由指示 ACTION_CANCEL）。</p>
<p>所述MotionEvent类提供许多方法来<strong>查询</strong>位置和指针，如其他性质getX(int)，getY(int)，getAxisValue(int)， getPointerId(int)，getToolType(int)，和许多其他。大多数这些方法接受<strong>指针索引</strong>作为参数，而不是指针ID。事件中每个指针的指针索引的范围从0到1小于返回的值getPointerCount()。</p>
<p>单个指针在运动事件中出现的顺序是不确定的。因此，指针的指针索引可以从一个事件改变到下一个，但是只要指<strong>针保持活动状态</strong>，指针的<strong>指针ID就保证保持不变</strong>。使用该getPointerId(int)方法获取指针的指针ID，以在手势中的所有后续运动事件中跟踪指针。然后对于连续运动事件，使用该findPointerIndex(int)方法获取该运动事件中给定指针标识的指针索引。</p>
<ul>
<li><strong>坐标</strong></li>
</ul>
<p>使用<strong>最新</strong>的指针坐标 ：使用<strong>getX(int)</strong>和可以<strong>getY(int)</strong>。<br>使用<strong>较早</strong>坐标 ： 使用 <strong>getHistoricalX(int, int)</strong>和访问批次内的<strong>getHistoricalY(int, int)</strong>。<br>坐标是“历史的”，只要它们比批中的当前坐标更早; 然而，它们仍然不同于之前的动作事件中报告的任何其他坐标。要按时间顺序处理批次中的所有坐标，请先消耗历史坐标，然后消耗当前坐标。</p>
<ul>
<li><strong>设备类型</strong></li>
</ul>
<p>MotionEvent内容的解释根据设备的源类别而有很大的不同。</p>
<ul>
<li><strong>一致性保证</strong></li>
</ul>
<p>运动事件始终作为事件的一致性流传递给视图。什么构成一个一致的流取决于设备的类型。对于触摸事件来说，一致性意味着指针一次一个地下移，一个一个地移动，然后一次一个地移动或取消。</p>
<h1 id="2-静态内部类MotionEvent-PointerCoords-：传递对象的指针坐标。"><a href="#2-静态内部类MotionEvent-PointerCoords-：传递对象的指针坐标。" class="headerlink" title="2. 静态内部类MotionEvent.PointerCoords ：传递对象的指针坐标。"></a>2. 静态内部类MotionEvent.PointerCoords ：传递对象的指针坐标。</h1><h1 id="3-静态内部类MotionEvent-PointerProperties-：传递对象的指针属性。"><a href="#3-静态内部类MotionEvent-PointerProperties-：传递对象的指针属性。" class="headerlink" title="3. 静态内部类MotionEvent.PointerProperties ：传递对象的指针属性。"></a>3. 静态内部类MotionEvent.PointerProperties ：传递对象的指针属性。</h1><h1 id="4-主要常量"><a href="#4-主要常量" class="headerlink" title="4. 主要常量"></a>4. 主要常量</h1><p>ACTION_MASK : 作为动作本身的动作代码部分的位掩码</p>
<table>
<thead>
<tr>
<th style="text-align:left">常量 getActionMasked()</th>
<th style="text-align:center">非触摸事件，所以它被传递给 onGenericMotionEvent(MotionEvent)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ACTION_BUTTON_PRESS</td>
<td style="text-align:center">按钮已被按下。常量值：11（0x0000000b）</td>
</tr>
<tr>
<td style="text-align:left">ACTION_BUTTON_RELEASE</td>
<td style="text-align:center">一个按钮已被释放。常量值：12（0x0000000c）</td>
</tr>
<tr>
<td style="text-align:left">ACTION_HOVER_ENTER</td>
<td style="text-align:center">指针未关闭，但已经进入窗口或视图的边界。常量值：9（0x00000009）</td>
</tr>
<tr>
<td style="text-align:left">ACTION_HOVER_EXIT</td>
<td style="text-align:center">指针没有关闭，但已经退出了窗口或视图的边界。常量值：10（0x0000000a）</td>
</tr>
<tr>
<td style="text-align:left">ACTION_HOVER_MOVE</td>
<td style="text-align:center">发生了改变，但指针没有下降（不像ACTION_MOVE）常量值：7（0x00000007）</td>
</tr>
<tr>
<td style="text-align:left">ACTION_SCROLL</td>
<td style="text-align:center">运动事件包含相对垂直和/或水平滚动偏移。常量值：8（0x00000008）</td>
</tr>
</tbody>
</table>
<hr>
<table>
<thead>
<tr>
<th style="text-align:left">常量 getActionMasked()</th>
<th style="text-align:center">使用getButtonState()检索按钮状态</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ACTION_DOWN</td>
<td style="text-align:center">按下的手势已经开始，运动包含初始起始位置。常量值：0（0x00000000）</td>
</tr>
<tr>
<td style="text-align:left">ACTION_MOVE</td>
<td style="text-align:center">在按下手势期间（在ACTION_DOWN和之间ACTION_UP）发生改变。常数值：2（0x00000002）</td>
</tr>
<tr>
<td style="text-align:left">ACTION_UP</td>
<td style="text-align:center">按下的手势已经完成，常数值 : 1 (0x00000001)</td>
</tr>
<tr>
<td style="text-align:left">ACTION_CANCEL</td>
<td style="text-align:center">当前手势已被中止。如果父视图希望拦截其中的一些事件，不再继续转发事件给这个子视图的话，那么就需要给子视图一个ACTION_CANCEL事件。常数值 :  3 (0x00000003)</td>
</tr>
<tr>
<td style="text-align:left">ACTION_OUTSIDE</td>
<td style="text-align:center">移动发生在UI元素的正常界限之外。注意：由于任何事件的位置都将超出视图层次结构的范围，因此默认情况下不会将其分派给ViewGroup的任何子项。因此，ACTION_OUTSIDE的移动应该以根View或适当的方式Window.Callback （例如Activity或Dialog）来处理。常量值：4（0x00000004）</td>
</tr>
<tr>
<td style="text-align:left">ACTION_POINTER_DOWN</td>
<td style="text-align:center">非主指针已关闭</td>
</tr>
<tr>
<td style="text-align:left">ACTION_POINTER_UP</td>
<td style="text-align:center">非主指针已经上升。</td>
</tr>
<tr>
<td style="text-align:left">ACTION_POINTER_INDEX_MASK</td>
<td style="text-align:center">代表指针索引的动作代码中的位，与 ACTION_POINTER_DOWN和一起使用</td>
</tr>
<tr>
<td style="text-align:left">ACTION_POINTER_UP。</td>
<td style="text-align:center">非主指针已经上升。常量值：1（0x00000001）</td>
</tr>
<tr>
<td style="text-align:left">ACTION_POINTER_INDEX_SHIFT</td>
<td style="text-align:center">按照定义，保存指针索引的动作位的位移ACTION_POINTER_INDEX_MASK</td>
</tr>
</tbody>
</table>
<h1 id="5-主要公共方法"><a href="#5-主要公共方法" class="headerlink" title="5. 主要公共方法"></a>5. 主要公共方法</h1><table>
<thead>
<tr>
<th style="text-align:left">公共方法</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">getAction()</td>
<td style="text-align:center">返回正在执行的操作。</td>
</tr>
<tr>
<td style="text-align:left">getActionButton()</td>
<td style="text-align:center">获取在按下或释放操作期间哪个按钮已被修改。</td>
</tr>
<tr>
<td style="text-align:left">findPointerIndex(int pointerId)</td>
<td style="text-align:center">给定一个指针标识符，在事件中找到它的数据索引</td>
</tr>
<tr>
<td style="text-align:left">getActionIndex()</td>
<td style="text-align:center">对于ACTION_POINTER_DOWN或ACTION_POINTER_UP 作为返回getActionMasked()，这将返回关联的指针索引。</td>
</tr>
<tr>
<td style="text-align:left">getActionMasked()</td>
<td style="text-align:center">返回正在执行的被屏蔽的操作，没有指针索引信息。</td>
</tr>
<tr>
<td style="text-align:left">getDeviceId()</td>
<td style="text-align:center">获取此事件来自的设备的ID。</td>
</tr>
<tr>
<td style="text-align:left">getDownTime()</td>
<td style="text-align:center">返回用户最初按下时启动位置事件流的时间（以毫秒为单位）。</td>
</tr>
<tr>
<td style="text-align:left">getFlags()</td>
<td style="text-align:center">获取运动事件标志。</td>
</tr>
<tr>
<td style="text-align:left">getHistoricalEventTime(int pos)</td>
<td style="text-align:center">返回在此事件和上一个事件之间发生历史移动的uptimeMillis()时间。</td>
</tr>
<tr>
<td style="text-align:left">getHistoricalOrientation(int pointerIndex, int pos)</td>
<td style="text-align:center">根据getOrientation(int)在此事件与给定指针的上一个事件之间发生的历史方向坐标返回历史方向坐标。</td>
</tr>
<tr>
<td style="text-align:left">setSource(int source)</td>
<td style="text-align:center">修改事件的来源。</td>
</tr>
<tr>
<td style="text-align:left">setLocation(float x, float y)</td>
<td style="text-align:center">设置这个事件的位置。</td>
</tr>
<tr>
<td style="text-align:left">offsetLocation(float deltaX, float deltaY)</td>
<td style="text-align:center">调整此事件的位置。</td>
</tr>
<tr>
<td style="text-align:left">setAction(int action)</td>
<td style="text-align:center">设置此事件的操作。</td>
</tr>
<tr>
<td style="text-align:left">recycle()</td>
<td style="text-align:center">回收MotionEvent，以供稍后调用者重新使用。</td>
</tr>
<tr>
<td style="text-align:left">getYPrecision()</td>
<td style="text-align:center">返回正在报告的Y坐标的精度。</td>
</tr>
<tr>
<td style="text-align:left">getY(int pointerIndex)</td>
<td style="text-align:center">返回给定指针索引的此事件的Y坐标 （用于getPointerId(int)查找此索引的指针标识符）。</td>
</tr>
<tr>
<td style="text-align:left">getY()</td>
<td style="text-align:center">getY(int) 为第一个指针索引（可能是一个任意的指针标识符）。</td>
</tr>
<tr>
<td style="text-align:left">getRawY()</td>
<td style="text-align:center">返回此事件的原始Y坐标。</td>
</tr>
<tr>
<td style="text-align:left">getPressure(int pointerIndex)</td>
<td style="text-align:center">返回给定指针索引的此事件的当前压力 （用于getPointerId(int)查找此索引的指针标识符）。</td>
</tr>
<tr>
<td style="text-align:left">getSize(int pointerIndex)</td>
<td style="text-align:center">返回给定指针索引的近似大小的缩放值 （用于getPointerId(int)查找此索引的指针标识符）。</td>
</tr>
<tr>
<td style="text-align:left">getPointerCount()</td>
<td style="text-align:center">包含在这个事件中的数据指针的数量。</td>
</tr>
<tr>
<td style="text-align:left">getOrientation(int pointerIndex)</td>
<td style="text-align:center">返回给定指针索引（用于getPointerId(int)查找此索引的指针标识符）的触摸区域和工具区域的方向，从垂直方向顺时针旋转弧度。</td>
</tr>
<tr>
<td style="text-align:left">getSource()</td>
<td style="text-align:center">获取事件的来源。</td>
</tr>
</tbody>
</table>
<h1 id="6-事件坐标的含义"><a href="#6-事件坐标的含义" class="headerlink" title="6. 事件坐标的含义"></a>6. 事件坐标的含义</h1><ul>
<li>getX()和getY()：由这两个函数获得的x,y值是相对的坐标值，相对于消费这个事件的视图的左上点的坐标。</li>
<li>getRawX()和getRawY():有这两个函数获得的x,y值是绝对坐标，是相对于屏幕的。</li>
</ul>
<p><img src="https://yannischeng-img-1258109292.cos.ap-beijing.myqcloud.com/623378-f45e4c2e22f0e8aa.png" alt=""></p>
<p>相对坐标与绝对坐标</p>
<h1 id="7-事件类型"><a href="#7-事件类型" class="headerlink" title="7. 事件类型"></a>7. 事件类型</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> action = MotionEventCompat.getActionMasked(event);</div><div class="line">   <span class="keyword">switch</span>(action) &#123;</div><div class="line">       <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line">           <span class="keyword">break</span>;</div><div class="line">       <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">           <span class="keyword">break</span>;</div><div class="line">       <span class="keyword">case</span> MotionEvent.ACTION_UP:</div><div class="line">           <span class="keyword">break</span>;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h1 id="8-Pointer"><a href="#8-Pointer" class="headerlink" title="8. Pointer"></a>8. Pointer</h1><p>为了可以表示多个触摸点的动作，MotionEvent中引入了Pointer的概念，一个pointer就代表一个触摸点，每个pointer都有自己的事件类型，也有自己的横轴坐标值。一个MotionEvent对象中可能会存储多个pointer的相关信息，每个pointer都会有一个自己的id和index。pointer的id在整个事件流中是不会发生变化的，但是index会发生变化。</p>
<p>MotionEvent类中的很多方法都是可以传入一个int值作为参数的，其实传入的就是pointer的index值。比如getX(pointerIndex)和getY(pointerIndex)，此时，它们返回的就是index所代表的触摸点相关事件坐标值。</p>
<p>由于pointer的index值在不同的MotionEvent对象中会发生变化，但是id值却不会变化。所以，当我们要记录一个触摸点的事件流时，就只需要保存其id,然后使用findPointerIndex(int)来获得其index值，然后再获得其他信息。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> INVALID_ID = -<span class="number">1</span>;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">int</span> mActivePointerId = INVALID_ID;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">int</span> mSecondaryPointerId = INVALID_ID;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">float</span> mPrimaryLastX = -<span class="number">1</span>;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">float</span> mPrimaryLastY = -<span class="number">1</span>;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">float</span> mSecondaryLastX = -<span class="number">1</span>;</div><div class="line">   <span class="keyword">private</span> <span class="keyword">float</span> mSecondaryLastY = -<span class="number">1</span>;</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</div><div class="line">       <span class="keyword">int</span> action = MotionEventCompat.getActionMasked(event);</div><div class="line"></div><div class="line">       <span class="keyword">switch</span> (action) &#123;</div><div class="line">           <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</div><div class="line">               <span class="keyword">int</span> index = event.getActionIndex();</div><div class="line">               mActivePointerId = event.getPointerId(index);</div><div class="line">               mPrimaryLastX = MotionEventCompat.getX(event,index);</div><div class="line">               mPrimaryLastY = MotionEventCompat.getY(event,index);</div><div class="line">               <span class="keyword">break</span>;</div><div class="line">           <span class="keyword">case</span> MotionEvent.ACTION_POINTER_DOWN:</div><div class="line">               <span class="keyword">int</span> index = event.getActionIndex();</div><div class="line">               mSecondaryPointerId = event.getPointerId(index);</div><div class="line">               mSecondaryLastX = event.getX(index);</div><div class="line">               mSecondaryLastY = event.getY(index);</div><div class="line">               <span class="keyword">break</span>;</div><div class="line">           <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</div><div class="line">               <span class="keyword">int</span> index = event.findPointerIndex(mActivePointerId);</div><div class="line">               <span class="keyword">int</span> secondaryIndex = MotionEventCompat.findPointerIndex(event,mSecondaryPointerId);</div><div class="line">               <span class="keyword">final</span> <span class="keyword">float</span> x = MotionEventCompat.getX(event,index);</div><div class="line">               <span class="keyword">final</span> <span class="keyword">float</span> y = MotionEventCompat.getY(event,index);</div><div class="line">               <span class="keyword">final</span> <span class="keyword">float</span> secondX = MotionEventCompat.getX(event,secondaryIndex);</div><div class="line">               <span class="keyword">final</span> <span class="keyword">float</span> secondY = MotionEventCompat.getY(event,secondaryIndex);</div><div class="line">               <span class="keyword">break</span>;</div><div class="line">           <span class="keyword">case</span> MotionEvent.ACTION_POINTER_UP:</div><div class="line">               xxxxxx(涉及pointer id的转换，之后的文章会讲解)</div><div class="line">               <span class="keyword">break</span>;</div><div class="line">           <span class="keyword">case</span> MotionEvent.ACTION_UP:</div><div class="line">           <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</div><div class="line">               mActivePointerId = INVALID_ID;</div><div class="line">               mPrimaryLastX =-<span class="number">1</span>;</div><div class="line">               mPrimaryLastY = -<span class="number">1</span>;</div><div class="line">               <span class="keyword">break</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>除了pointer的概念，MotionEvent还引入了两个事件类型：</p>
<ul>
<li>ACTION_POINTER_DOWN:代表用户又使用一个手指触摸到屏幕上，也就是说，在已经有一个触摸点的情况下，有新出现了一个触摸点。</li>
<li>ACTION_POINTER_UP:代表用户的一个手指离开了触摸屏，但是还有其他手指还在触摸屏上。也就是说，在多个触摸点存在的情况下，其中一个触摸点消失了。它与ACTION_UP的区别就是，它是在多个触摸点中的一个触摸点消失时（此时，还有触摸点存在，也就是说用户还有手指触摸屏幕）产生，而ACTION_UP可以说是最后一个触摸点消失时产生。</li>
</ul>
<p>那么，用户先两个手指先后接触屏幕，同时滑动，然后在先后离开这一套动作所产生的事件流是什么样的呢？它所产生的事件流如下：</p>
<ul>
<li>先产生一个ACTION_DOWN事件，代表用户的第一个手指接触到了屏幕。</li>
<li>再产生一个ACTION_POINTER_DOWN事件，代表用户的第二个手指接触到了屏幕。<br>很多的ACTION_MOVE事件，但是在这些MotionEvent对象中，都保存着两个触摸点滑动的信息</li>
<li>一个ACTION_POINTER_UP事件，代表用户的一个手指离开了屏幕。<br>如果用户剩下的手指还在滑动时，就会产生很多ACTION_MOVE事件。</li>
<li>一个ACTION_UP事件，代表用户的最后一个手指离开了屏幕</li>
</ul>
<h1 id="9-getAction-和-getActionMasked"><a href="#9-getAction-和-getActionMasked" class="headerlink" title="9. getAction 和 getActionMasked"></a>9. getAction 和 getActionMasked</h1><p>一个MotionEvent对象中可以包含多个触摸点的事件。当MotionEvent对象只包含一个触摸点的事件时，上边两个函数的结果是相同的，但是当包含多个触摸点时，二者的结果就不同啦。<br>getAction获得的int值是由pointer的index值和事件类型值组合而成的，而getActionWithMasked则只返回事件的类型值<br> 举个例子（注:假设了int中不同位所代表的含义，可能不是例子所中的前8位代表id,后8位代表事件类型）:
 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">getAction() returns <span class="number">0x0105</span>.</div><div class="line">getActionMasked() will <span class="keyword">return</span> <span class="number">0x0005</span></div><div class="line">其中<span class="number">0x0100</span>就是pointer的index值。</div></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    


    <footer class="post-footer">
      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Android使用频率较少的控件/" rel="next" title="Android 使用频率较少的控件">
                <i class="fa fa-chevron-left"></i> Android 使用频率较少的控件
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/开源库-RxJava/" rel="prev" title="开源库-RxJava">
                开源库-RxJava <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="http://oy991qm3u.bkt.clouddn.com/%E6%A2%B5%E9%AB%98.gif"
                alt="YannisCheng" />
            
              <p class="site-author-name" itemprop="name">YannisCheng</p>
              <p class="site-description motion-element" itemprop="description">不必一味的讨好别人，每个人都有自己的活法。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">123</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">24</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">62</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/YannisCheng" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:cwj1714@163.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#相关的类"><span class="nav-number">1.</span> <span class="nav-text">相关的类</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Android事件响应机制"><span class="nav-number">2.</span> <span class="nav-text">Android事件响应机制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1-概述：MotionEvent-用于报告移动事件对象"><span class="nav-number">3.</span> <span class="nav-text">1. 概述：MotionEvent 用于报告移动事件对象</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-静态内部类MotionEvent-PointerCoords-：传递对象的指针坐标。"><span class="nav-number">4.</span> <span class="nav-text">2. 静态内部类MotionEvent.PointerCoords ：传递对象的指针坐标。</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-静态内部类MotionEvent-PointerProperties-：传递对象的指针属性。"><span class="nav-number">5.</span> <span class="nav-text">3. 静态内部类MotionEvent.PointerProperties ：传递对象的指针属性。</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-主要常量"><span class="nav-number">6.</span> <span class="nav-text">4. 主要常量</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-主要公共方法"><span class="nav-number">7.</span> <span class="nav-text">5. 主要公共方法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-事件坐标的含义"><span class="nav-number">8.</span> <span class="nav-text">6. 事件坐标的含义</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-事件类型"><span class="nav-number">9.</span> <span class="nav-text">7. 事件类型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-Pointer"><span class="nav-number">10.</span> <span class="nav-text">8. Pointer</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-getAction-和-getActionMasked"><span class="nav-number">11.</span> <span class="nav-text">9. getAction 和 getActionMasked</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2016 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YannisCheng</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">262.4k</span>
  
</div>













        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.3"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.3"></script>


  


<script type="text/javascript" color="18,146,19" opacity='0.7' zIndex="-1" count="0" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script>

</body>
</html>
